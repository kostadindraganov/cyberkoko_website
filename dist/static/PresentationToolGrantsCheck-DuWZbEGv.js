const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/QRCodeSVG-i9cPYuqV.js","static/sanity-CNmy13iJ.js","static/LiveQueries-BYKAReo7.js","static/DisplayedDocumentBroadcaster-BjOgLLAP.js","static/PostMessageDocuments-BBiwck0x.js","static/PostMessageRefreshMutations-C2tmjLrr.js","static/PostMessagePerspective-DrTvN2UK.js","static/PostMessagePreviewSnapshots-DL-hoesY.js","static/PostMessageSchema-OvzjbWyW.js","static/PostMessageTelemetry-D1melqOg.js"])))=>i.map(i=>d[i]);
import{a4 as ar,a5 as ir,aW as pt,aX as or,r as m,aY as Xt,aZ as cr,j as u,a_ as lr,a$ as mn,b0 as hn,b1 as St,b2 as Ae,b3 as Ze,b4 as Ue,b5 as ur,b6 as ft,b7 as dr,b8 as pr,av as _t,b9 as mt,ba as gn,bb as Tt,bc as fr,bd as mr,be as jt,bf as hr,bg as gr,bh as yr,bi as Ct,bj as It,bk as He,bl as Ne,bm as At,bn as $t,bo as Oe,bp as qe,bq as kt,aw as yn,br,bs as bn,bt as vr,bu as wr,b as z,i as be,bv as ve,h as vn,bw as xr,bx as wn,u as Ge,by as Pr,ad as Mt,bz as xn,e as Sr,bA as _r,bB as jr,bC as Er,L as Rr,bD as Pn,bE as Tr,bF as Jt,bG as Sn,a6 as Cr,bH as Ir,bI as Ar,F as re,bJ as $r,bK as Xe,bL as _n,bM as lt,bN as kr,bO as Mr,bP as Or,bQ as Lr,bR as zr,bS as Dr,z as fe,bT as Ot,bU as Lt,bV as Ur,bW as jn,bX as Qt,bY as Wr,bZ as Nr,C as de,b_ as En,b$ as Je,ai as _e,k as nt,T as X,S as Le,Z as rt,f as st,a1 as ke,c0 as zt,c1 as qr,c2 as Vr,c3 as Fr,c4 as Hr,I as Br,n as pe,a as Kr,c5 as ut,c6 as Gr,c7 as Xr,G as Jr,c8 as Ve,c9 as Rn,ca as Qr,cb as Yr,s as Zr,cc as es,w as ts,cd as ns,ce as Tn,cf as Cn,cg as rs,al as ss,ch as as,ci as is,cj as os,aM as cs,x as ls,ck as us,p as ds,cl as In,cm as Dt,cn as ps,aq as An,co as fs,a7 as $n,aN as kn,au as ms,cp as hs,cq as gs,cr as ys,cs as bs,ct as vs,cu as ws,cv as xs,cw as Ps}from"./sanity-CNmy13iJ.js";import{i as Ss,D as _s}from"./DisplayedDocumentBroadcaster-BjOgLLAP.js";function js(t,e){return e===void 0&&(e=null),e=e??t,ar(function(n,s){var r=[],a=0;n.subscribe(ir(s,function(i){var o,c,l,p,d=null;a++%e===0&&r.push([]);try{for(var y=pt(r),f=y.next();!f.done;f=y.next()){var b=f.value;b.push(i),t<=b.length&&(d=d??[],d.push(b))}}catch(g){o={error:g}}finally{try{f&&!f.done&&(c=y.return)&&c.call(y)}finally{if(o)throw o.error}}if(d)try{for(var h=pt(d),v=h.next();!v.done;v=h.next()){var b=v.value;or(r,b),s.next(b)}}catch(g){l={error:g}}finally{try{v&&!v.done&&(p=h.return)&&p.call(h)}finally{if(l)throw l.error}}},function(){var i,o;try{for(var c=pt(r),l=c.next();!l.done;l=c.next()){var p=l.value;s.next(p)}}catch(d){i={error:d}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}s.complete()},void 0,function(){r=null}))})}function Es({children:t,isValidProp:e,...n}){e&&lr(e),n={...m.useContext(Xt),...n},n.isStatic=cr(()=>n.isStatic);const s=m.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return u.jsx(Xt.Provider,{value:s,children:t})}const Rs=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ut=/_key\s*==\s*['"](.*)['"]/,Ts=/^\d*:\d*$/;function Wt(t){return typeof t=="number"||typeof t=="string"&&/^\[\d+\]$/.test(t)}function dt(t){return typeof t=="string"?Ut.test(t.trim()):typeof t=="object"&&"_key"in t}function Mn(t){if(typeof t=="string"&&Ts.test(t))return!0;if(!Array.isArray(t)||t.length!==2)return!1;const[e,n]=t;return(typeof e=="number"||e==="")&&(typeof n=="number"||n==="")}function Cs(t,e,n){const s=typeof e=="string"?On(e):e;if(!Array.isArray(s))throw new Error("Path must be an array or a string");let r=t;for(let a=0;a<s.length;a++){const i=s[a];if(Wt(i)){if(!Array.isArray(r))return n;r=r[i]}if(dt(i)){if(!Array.isArray(r))return n;r=r.find(o=>o._key===i._key)}if(typeof i=="string"&&(r=typeof r=="object"&&r!==null?r[i]:void 0),typeof r>"u")return n}return r}function Is(t){if(!Array.isArray(t))throw new Error("Path is not an array");return t.reduce((e,n,s)=>{const r=typeof n;if(r==="number")return`${e}[${n}]`;if(r==="string")return`${e}${s===0?"":"."}${n}`;if(dt(n)&&n._key)return`${e}[_key=="${n._key}"]`;if(Array.isArray(n)){const[a,i]=n;return`${e}[${a}:${i}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(n)}\``)},"")}function On(t){if(typeof t!="string")throw new Error("Path is not a string");const e=t.match(Rs);if(!e)throw new Error("Invalid path string");return e.map(As)}function As(t){return Wt(t)?$s(t):dt(t)?ks(t):Mn(t)?Ms(t):t}function $s(t){return Number(t.replace(/[^\d]/g,""))}function ks(t){return{_key:t.match(Ut)[1]}}function Ms(t){const[e,n]=t.split(":").map(s=>s===""?s:Number(s));return[e,n]}var Ln=Object.freeze({__proto__:null,fromString:On,get:Cs,isIndexSegment:Wt,isIndexTuple:Mn,isKeySegment:dt,reKeySegment:Ut,toString:Is});const Os="drafts",Ls="versions",Be=".",at=`${Os}${Be}`,zn=`${Ls}${Be}`;function Dn(t){return t.startsWith(at)}function Un(t){return t.startsWith(zn)}function Co(t){if(Un(t)){const e=Wn(t);return at+e}return Dn(t)?t:at+t}function Io(t,e){if(e==="drafts"||e==="published")throw new Error('Version can not be "published" or "drafts"');return`${zn}${e}${Be}${Wn(t)}`}function Wn(t){return Un(t)?t.split(Be).slice(2).join(Be):Dn(t)?t.slice(at.length):t}const Yt={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},Zt={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function zs(t){return`$${t.map(e=>typeof e=="string"?`['${e.replace(/[\f\n\r\t'\\]/g,n=>Yt[n])}']`:typeof e=="number"?`[${e}]`:e._key!==""?`[?(@._key=='${e._key.replace(/['\\]/g,n=>Yt[n])}')]`:`[${e._index}]`).join("")}`}function Ao(t){const e=[],n=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let s;for(;(s=n.exec(t))!==null;){if(s[1]!==void 0){const r=s[1].replace(/\\(\\|f|n|r|t|')/g,a=>Zt[a]);e.push(r);continue}if(s[2]!==void 0){e.push(parseInt(s[2],10));continue}if(s[3]!==void 0){const r=s[3].replace(/\\(\\')/g,a=>Zt[a]);e.push({_key:r,_index:-1});continue}}return e}function Ds(t){return t.map(e=>{if(typeof e=="string"||typeof e=="number")return e;if(e._index!==-1)return e._index;throw new Error(`invalid segment:${JSON.stringify(e)}`)})}function $o(t,e){if(!(e!=null&&e.mappings))return;const n=zs(Ds(t));if(e.mappings[n]!==void 0)return{mapping:e.mappings[n],matchedPath:n,pathSuffix:""};const s=Object.entries(e.mappings).filter(([o])=>n.startsWith(o)).sort(([o],[c])=>c.length-o.length);if(s.length==0)return;const[r,a]=s[0],i=n.substring(r.length);return{mapping:a,matchedPath:r,pathSuffix:i}}function Us(t){return t!==null&&Array.isArray(t)}function en(t){return typeof t=="object"&&t!==null}function We(t,e,n=[]){if(Us(t))return t.map((s,r)=>{if(en(s)){const a=s._key;if(typeof a=="string")return We(s,e,n.concat({_key:a,_index:r}))}return We(s,e,n.concat(r))});if(en(t)){if(t._type==="block"||t._type==="span"){const s={...t};return t._type==="block"?s.children=We(t.children,e,n.concat("children")):t._type==="span"&&(s.text=We(t.text,e,n.concat("text"))),s}return Object.fromEntries(Object.entries(t).map(([s,r])=>[s,We(r,e,n.concat(s))]))}return e(t,n)}const te=[];for(let t=0;t<256;++t)te.push((t+256).toString(16).slice(1));function Ws(t,e=0){return(te[t[e+0]]+te[t[e+1]]+te[t[e+2]]+te[t[e+3]]+"-"+te[t[e+4]]+te[t[e+5]]+"-"+te[t[e+6]]+te[t[e+7]]+"-"+te[t[e+8]]+te[t[e+9]]+"-"+te[t[e+10]]+te[t[e+11]]+te[t[e+12]]+te[t[e+13]]+te[t[e+14]]+te[t[e+15]]).toLowerCase()}let ht;const Ns=new Uint8Array(16);function qs(){if(!ht){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ht=crypto.getRandomValues.bind(crypto)}return ht(Ns)}const Vs=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),tn={randomUUID:Vs};function Fe(t,e,n){var r;if(tn.randomUUID&&!t)return tn.randomUUID();t=t||{};const s=t.random??((r=t.rng)==null?void 0:r.call(t))??qs();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Ws(s)}const nn=t=>({context:e})=>{const{count:n,include:s,exclude:r,responseType:a="message.received"}=t;return{count:n,domain:e.domain,from:e.connectTo,include:s?Array.isArray(s)?s:[s]:[],exclude:r?Array.isArray(r)?r:[r]:[],responseType:a,target:e.target,to:e.name}},Fs=t=>e=>{const{data:n}=e;return(t.include.length?t.include.includes(n.type):!0)&&(t.exclude.length?!t.exclude.includes(n.type):!0)&&n.domain===t.domain&&n.from===t.from&&n.to===t.to&&(!t.target||e.source===t.target)},Hs=t=>e=>({type:t,message:e}),Bs=pr(()=>jt(window,"message")),Nn=t=>hn(({input:e})=>Bs.pipe(t?_t(t):mt(),gn(Fs(e)),_t(Hs(e.responseType)),e.count?mt(js(e.count),fr(n=>n),Tt(e.count)):mt())),Nt="sanity/comlink",Ks=3e3,Gs=500,Ke="comlink/response",it="comlink/heartbeat",qt="comlink/disconnect",Vt="comlink/handshake/syn",Ft="comlink/handshake/syn-ack",Ht="comlink/handshake/ack",Xs=t=>e=>e.pipe(Tt(1),_t(()=>{throw new Error(t)})),qn=()=>mn({actors:{listen:hn(({input:t})=>{const e=t.signal?jt(t.signal,"abort").pipe(Xs(`Request ${t.requestId} aborted`)):hr,n=s=>{var r,a;return((r=s.data)==null?void 0:r.type)===Ke&&((a=s.data)==null?void 0:a.responseTo)===t.requestId&&!!s.source&&t.sources.has(s.source)};return jt(window,"message").pipe(gn(n),Tt(t.sources.size),gr(e))})},actions:{"send message":({context:t},e)=>{const{sources:n,targetOrigin:s}=t,{message:r}=e;n.forEach(a=>{a.postMessage(r,{targetOrigin:s})})},"on success":ft(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return t.response&&((n=t.resolvable)==null||n.resolve(t.response)),{type:"request.success",requestId:e.id,response:t.response,responseTo:t.responseTo}}),"on fail":ft(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return t.suppressWarnings||console.warn(`[@sanity/comlink] Received no response to message '${t.type}' on client '${t.from}' (ID: '${t.id}').`),(n=t.resolvable)==null||n.reject(new Error("No response received")),{type:"request.failed",requestId:e.id}}),"on abort":ft(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return(n=t.resolvable)==null||n.reject(new Error("Request aborted")),{type:"request.aborted",requestId:e.id}})},guards:{expectsResponse:({context:t})=>t.expectResponse},delays:{initialTimeout:0,responseTimeout:({context:t})=>t.responseTimeout??Ks}}).createMachine({context:({input:t})=>({channelId:t.channelId,data:t.data,domain:t.domain,expectResponse:t.expectResponse??!1,from:t.from,id:`msg-${Fe()}`,parentRef:t.parentRef,resolvable:t.resolvable,response:null,responseTimeout:t.responseTimeout,responseTo:t.responseTo,signal:t.signal,sources:t.sources instanceof Set?t.sources:new Set([t.sources]),suppressWarnings:t.suppressWarnings,targetOrigin:t.targetOrigin,to:t.to,type:t.type}),initial:"idle",on:{abort:".aborted"},states:{idle:{after:{initialTimeout:[{target:"sending"}]}},sending:{entry:{type:"send message",params:({context:t})=>{const{channelId:e,data:n,domain:s,from:r,id:a,responseTo:i,to:o,type:c}=t;return{message:{channelId:e,data:n,domain:s,from:r,id:a,to:o,type:c,responseTo:i}}}},always:[{guard:"expectsResponse",target:"awaiting"},"success"]},awaiting:{invoke:{id:"listen for response",src:"listen",input:({context:t})=>({requestId:t.id,sources:t.sources,signal:t.signal}),onError:"aborted"},after:{responseTimeout:"failed"},on:{message:{actions:St({response:({event:t})=>t.data.data,responseTo:({event:t})=>t.data.responseTo}),target:"success"}}},failed:{type:"final",entry:"on fail"},success:{type:"final",entry:"on success"},aborted:{type:"final",entry:"on abort"}},output:({context:t,self:e})=>({requestId:e.id,response:t.response,responseTo:t.responseTo})}),Js=yr(({sendBack:t,input:e})=>{const n=()=>{t(e.event)};e.immediate&&n();const s=setInterval(n,e.interval);return()=>{clearInterval(s)}}),ot=()=>mn({actors:{requestMachine:qn(),listen:Nn(),sendBackAtInterval:Js},actions:{"buffer message":Ze(({enqueue:t})=>{t.assign({buffer:({event:e,context:n})=>(Ae(e,"post"),[...n.buffer,e.data])}),t.emit(({event:e})=>(Ae(e,"post"),{type:"buffer.added",message:e.data}))}),"create request":St({requests:({context:t,event:e,self:n,spawn:s})=>{Ae(e,"request");const r=(Array.isArray(e.data)?e.data:[e.data]).map(a=>{const i=`req-${Fe()}`;return s("requestMachine",{id:i,input:{channelId:t.channelId,data:a.data,domain:t.domain,expectResponse:a.expectResponse,from:t.name,parentRef:n,responseTo:a.responseTo,sources:t.target,targetOrigin:t.targetOrigin,to:t.connectTo,type:a.type}})});return[...t.requests,...r]}}),"emit received message":Ze(({enqueue:t})=>{t.emit(({event:e})=>(Ae(e,"message.received"),{type:"message",message:e.message.data}))}),"emit status":ur((t,e)=>({type:"status",status:e.status})),"post message":Ue(({event:t})=>(Ae(t,"post"),{type:"request",data:{data:t.data.data,expectResponse:!0,type:t.data.type}})),"remove request":Ze(({context:t,enqueue:e,event:n})=>{Ae(n,["request.success","request.failed","request.aborted"]),mr(n.requestId),e.assign({requests:t.requests.filter(({id:s})=>s!==n.requestId)})}),respond:Ue(({event:t})=>(Ae(t,"response"),{type:"request",data:{data:t.data,type:Ke,responseTo:t.respondTo}})),"send handshake ack":Ue({type:"request",data:{type:Ht}}),"send disconnect":Ue(()=>({type:"request",data:{type:qt}})),"send handshake syn":Ue({type:"request",data:{type:Vt}}),"send pending messages":Ze(({enqueue:t})=>{t.raise(({context:e})=>({type:"request",data:e.buffer.map(({data:n,type:s})=>({data:n,type:s}))})),t.emit(({context:e})=>({type:"buffer.flushed",messages:e.buffer})),t.assign({buffer:[]})}),"set target":St({target:({event:t})=>(Ae(t,"target.set"),t.target)})},guards:{"has target":({context:t})=>!!t.target,"should send heartbeats":({context:t})=>t.heartbeat}}).createMachine({id:"connection",context:({input:t})=>({id:t.id||`${t.name}-${Fe()}`,buffer:[],channelId:`chn-${Fe()}`,connectTo:t.connectTo,domain:t.domain??Nt,heartbeat:t.heartbeat??!1,name:t.name,requests:[],target:t.target,targetOrigin:t.targetOrigin}),on:{"target.set":{actions:"set target"},"request.success":{actions:"remove request"},"request.failed":{actions:"remove request"}},initial:"idle",states:{idle:{entry:[{type:"emit status",params:{status:"idle"}}],on:{connect:{target:"handshaking",guard:"has target"},post:{actions:"buffer message"}}},handshaking:{id:"handshaking",entry:[{type:"emit status",params:{status:"handshaking"}}],invoke:[{id:"send syn",src:"sendBackAtInterval",input:()=>({event:{type:"syn"},interval:Gs,immediate:!0})},{id:"listen for handshake",src:"listen",input:t=>nn({include:Ft,count:1})(t)}],on:{syn:{actions:"send handshake syn"},request:{actions:"create request"},post:{actions:"buffer message"},"message.received":{target:"connected"},disconnect:{target:"disconnected"}},exit:"send handshake ack"},connected:{entry:["send pending messages",{type:"emit status",params:{status:"connected"}}],invoke:{id:"listen for messages",src:"listen",input:nn({exclude:[Ke,it]})},on:{post:{actions:"post message"},request:{actions:"create request"},response:{actions:"respond"},"message.received":{actions:"emit received message"},disconnect:{target:"disconnected"}},initial:"heartbeat",states:{heartbeat:{initial:"checking",states:{checking:{always:{guard:"should send heartbeats",target:"sending"}},sending:{on:{"request.failed":{target:"#handshaking"}},invoke:{id:"send heartbeat",src:"sendBackAtInterval",input:()=>({event:{type:"post",data:{type:it,data:void 0}},interval:2e3,immediate:!1})}}}}}},disconnected:{id:"disconnected",entry:["send disconnect",{type:"emit status",params:{status:"disconnected"}}],on:{request:{actions:"create request"},post:{actions:"buffer message"},connect:{target:"handshaking",guard:"has target"}}}}}),gt=(t,e=ot())=>{const n=t.id||`${t.name}-${Fe()}`,s=dr(e,{input:{...t,id:n}}),r=new Map,a=new Map,i=(b,h,v)=>{const g=r.get(b)||new Set;r.has(b)||r.set(b,g),g.add(h);const w=a.get(b);if(w){const P=(v==null?void 0:v.replay)??1;Array.from(w).slice(-P).forEach(async({data:x,id:j})=>{const R=await h(x);R&&s.send({type:"response",respondTo:j,data:R})}),a.delete(b)}return()=>{g.delete(h)}},o=()=>{s.send({type:"connect"})},c=()=>{s.send({type:"disconnect"})},l=(b,h)=>{const{unsubscribe:v}=s.on("status",g=>{h&&g.status!==h||b(g.status)});return v},p=b=>{s.send({type:"target.set",target:b})},d=(b,h)=>{const v={type:b,data:h};s.send({type:"post",data:v})};s.on("message",async({message:b})=>{const h=r.get(b.type);if(h){h.forEach(async g=>{const w=await g(b.data);w&&s.send({type:"response",respondTo:b.id,data:w})});return}const v=a.get(b.type);v?v.add(b):a.set(b.type,new Set([b]))});const y=()=>{s.stop()},f=()=>(s.start(),y);return{actor:s,connect:o,disconnect:c,id:n,name:t.name,machine:e,on:i,onStatus:l,post:d,setTarget:p,start:f,stop:y,get target(){return s.getSnapshot().context.target}}},yt=t=>{t.disconnect(),setTimeout(()=>{t.stop()},0)},Qs=()=>{},Ys=t=>{const{targetOrigin:e}=t,n=new Set,s=new Set;return{addTarget:r=>{if(n.has(r))return Qs;if(!n.size||!s.size)return n.add(r),s.forEach(i=>{i.connections.forEach(o=>{o.setTarget(r),o.connect()})}),()=>{n.delete(r),s.forEach(i=>{i.connections.forEach(o=>{o.target===r&&o.disconnect()})})};n.add(r);const a=new Set;return s.forEach(i=>{const o=gt({...i.input,target:r,targetOrigin:e},i.machine);a.add(o),i.connections.add(o),i.subscribers.forEach(({type:c,handler:l,unsubscribers:p})=>{p.push(o.on(c,l))}),i.internalEventSubscribers.forEach(({type:c,handler:l,unsubscribers:p})=>{p.push(o.actor.on(c,l).unsubscribe)}),i.statusSubscribers.forEach(({handler:c,unsubscribers:l})=>{l.push(o.onStatus(p=>c({connection:o.id,status:p})))}),o.start(),o.connect()}),()=>{n.delete(r),a.forEach(i=>{yt(i),s.forEach(o=>{o.connections.delete(i)})})}},createChannel:(r,a=ot())=>{const i={connections:new Set,input:r,internalEventSubscribers:new Set,machine:a,statusSubscribers:new Set,subscribers:new Set};s.add(i);const{connections:o,internalEventSubscribers:c,statusSubscribers:l,subscribers:p}=i;if(n.size)n.forEach(v=>{const g=gt({...r,target:v,targetOrigin:e},a);o.add(g)});else{const v=gt({...r,targetOrigin:e},a);o.add(v)}const d=(...v)=>{const[g,w]=v;o.forEach(P=>{P.post(g,w)})},y=(v,g)=>{const w=[];o.forEach(x=>{w.push(x.on(v,g))});const P={type:v,handler:g,unsubscribers:w};return p.add(P),()=>{w.forEach(x=>x()),p.delete(P)}},f=(v,g)=>{const w=[];o.forEach(x=>{w.push(x.actor.on(v,g).unsubscribe)});const P={type:v,handler:g,unsubscribers:w};return c.add(P),()=>{w.forEach(x=>x()),c.delete(P)}},b=v=>{const g=[];o.forEach(P=>{g.push(P.onStatus(x=>v({connection:P.id,status:x})))});const w={handler:v,unsubscribers:g};return l.add(w),()=>{g.forEach(P=>P()),l.delete(w)}},h=()=>{const v=i.connections;v.forEach(yt),v.clear(),s.delete(i)};return{on:y,onInternalEvent:f,onStatus:b,post:d,start:()=>(o.forEach(v=>{v.start(),v.connect()}),h),stop:h}},destroy:()=>{s.forEach(({connections:r})=>{r.forEach(yt),r.clear()}),s.clear(),n.clear()}}},Zs={"handshake/syn":Vt,"handshake/syn-ack":Ft,"handshake/ack":Ht,"channel/response":Ke,"channel/heartbeat":it,"channel/disconnect":qt,"overlay/focus":"visual-editing/focus","overlay/navigate":"visual-editing/navigate","overlay/toggle":"visual-editing/toggle","presentation/toggleOverlay":"presentation/toggle-overlay"},ea={[Vt]:"handshake/syn",[Ft]:"handshake/syn-ack",[Ht]:"handshake/ack",[Ke]:"channel/response",[it]:"channel/heartbeat",[qt]:"channel/disconnect","visual-editing/focus":"overlay/focus","visual-editing/navigate":"overlay/navigate","visual-editing/toggle":"overlay/toggle","presentation/toggle-overlay":"presentation/toggleOverlay"},ta=t=>{const{data:e}=t;return e&&typeof e=="object"&&"domain"in e&&"type"in e&&"from"in e&&"to"in e&&(e.domain==="sanity/channels"&&(e.domain=Nt),e.to==="overlays"&&(e.to="visual-editing"),e.from==="overlays"&&(e.from="visual-editing"),e.channelId=e.connectionId,delete e.connectionId,e.type=Zs[e.type]??e.type),t},na=t=>{const{channelId:e,...n}=t,s={...n,connectionId:e};return s.domain===Nt&&(s.domain="sanity/channels"),s.to==="visual-editing"&&(s.to="overlays"),s.from==="visual-editing"&&(s.from="overlays"),s.type=ea[s.type]??s.type,s.type==="channel/response"&&s.responseTo&&!s.data&&(s.data={responseTo:s.responseTo}),(s.type==="handshake/syn"||s.type==="handshake/syn-ack"||s.type==="handshake/ack")&&(s.data={id:s.connectionId}),s},ra=({context:t},e)=>{const{sources:n,targetOrigin:s}=t,r=na(e.message);n.forEach(a=>{a.postMessage(r,{targetOrigin:s})})},rn=()=>({listen:Nn(ta),requestMachine:qn().provide({actions:{"send message":ra}})}),ne=[];for(let t=0;t<256;++t)ne.push((t+256).toString(16).slice(1));function sa(t,e=0){return(ne[t[e+0]]+ne[t[e+1]]+ne[t[e+2]]+ne[t[e+3]]+"-"+ne[t[e+4]]+ne[t[e+5]]+"-"+ne[t[e+6]]+ne[t[e+7]]+"-"+ne[t[e+8]]+ne[t[e+9]]+"-"+ne[t[e+10]]+ne[t[e+11]]+ne[t[e+12]]+ne[t[e+13]]+ne[t[e+14]]+ne[t[e+15]]).toLowerCase()}let bt;const aa=new Uint8Array(16);function ia(){if(!bt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");bt=crypto.getRandomValues.bind(crypto)}return bt(aa)}const oa=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),sn={randomUUID:oa};function ca(t,e,n){var r;if(sn.randomUUID&&!t)return sn.randomUUID();t=t||{};const s=t.random??((r=t.rng)==null?void 0:r.call(t))??ia();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,sa(s)}function la(t){const e=new URL(t),{searchParams:n}=e;return n.delete(Ct),n.delete(It),n.delete(He),n.delete(Ne),n.delete(At),e}function ua(t,e,n,s){const r=new URL(t),{searchParams:a}=r;return e&&(a.set(It,e),a.set(Ct,n)),a.set(He,s),r}function Vn(){if(typeof crypto<"u"){const t=new Uint8Array(16);crypto.getRandomValues(t);let e="";for(let n=0;n<t.length;n++)e+=t[n].toString(16).padStart(2,"0");return e=btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),e}return Math.random().toString(36).slice(2)}async function da(t,e,n,s){const r=t.withConfig({apiVersion:$t}),a=Vn(),i=r.patch(Oe).set({secret:a,studioUrl:n,userId:s});return await r.transaction().createIfNotExists({_id:Oe,_type:qe,source:e,studioUrl:n,userId:s}).patch(i).commit({tag:kt}),{secret:a}}async function pa(t,e,n,s){const r=t.withConfig({apiVersion:$t}),a=r.patch(Oe).set({secret:null,studioUrl:n,userId:s});await r.transaction().createIfNotExists({_id:Oe,_type:qe,source:e,studioUrl:n,userId:s}).patch(a).commit({tag:kt})}function fa(t){for(var e=[],n=0;n<t.length;){var s=t[n];if(s==="*"||s==="+"||s==="?"){e.push({type:"MODIFIER",index:n,value:t[n++]});continue}if(s==="\\"){e.push({type:"ESCAPED_CHAR",index:n++,value:t[n++]});continue}if(s==="{"){e.push({type:"OPEN",index:n,value:t[n++]});continue}if(s==="}"){e.push({type:"CLOSE",index:n,value:t[n++]});continue}if(s===":"){for(var r="",a=n+1;a<t.length;){var i=t.charCodeAt(a);if(i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122||i===95){r+=t[a++];continue}break}if(!r)throw new TypeError("Missing parameter name at ".concat(n));e.push({type:"NAME",index:n,value:r}),n=a;continue}if(s==="("){var o=1,c="",a=n+1;if(t[a]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(a));for(;a<t.length;){if(t[a]==="\\"){c+=t[a++]+t[a++];continue}if(t[a]===")"){if(o--,o===0){a++;break}}else if(t[a]==="("&&(o++,t[a+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(a));c+=t[a++]}if(o)throw new TypeError("Unbalanced pattern at ".concat(n));if(!c)throw new TypeError("Missing pattern at ".concat(n));e.push({type:"PATTERN",index:n,value:c}),n=a;continue}e.push({type:"CHAR",index:n,value:t[n++]})}return e.push({type:"END",index:n,value:""}),e}function ma(t,e){e===void 0&&(e={});for(var n=fa(t),s=e.prefixes,r=s===void 0?"./":s,a=e.delimiter,i=a===void 0?"/#?":a,o=[],c=0,l=0,p="",d=function(S){if(l<n.length&&n[l].type===S)return n[l++].value},y=function(S){var E=d(S);if(E!==void 0)return E;var C=n[l],$=C.type,A=C.index;throw new TypeError("Unexpected ".concat($," at ").concat(A,", expected ").concat(S))},f=function(){for(var S="",E;E=d("CHAR")||d("ESCAPED_CHAR");)S+=E;return S},b=function(S){for(var E=0,C=i;E<C.length;E++){var $=C[E];if(S.indexOf($)>-1)return!0}return!1},h=function(S){var E=o[o.length-1],C=S||(E&&typeof E=="string"?E:"");if(E&&!C)throw new TypeError('Must have text between two parameters, missing text after "'.concat(E.name,'"'));return!C||b(C)?"[^".concat($e(i),"]+?"):"(?:(?!".concat($e(C),")[^").concat($e(i),"])+?")};l<n.length;){var v=d("CHAR"),g=d("NAME"),w=d("PATTERN");if(g||w){var P=v||"";r.indexOf(P)===-1&&(p+=P,P=""),p&&(o.push(p),p=""),o.push({name:g||c++,prefix:P,suffix:"",pattern:w||h(P),modifier:d("MODIFIER")||""});continue}var x=v||d("ESCAPED_CHAR");if(x){p+=x;continue}p&&(o.push(p),p="");var j=d("OPEN");if(j){var P=f(),R=d("NAME")||"",_=d("PATTERN")||"",I=f();y("CLOSE"),o.push({name:R||(_?c++:""),pattern:R&&!_?h(P):_,prefix:P,suffix:I,modifier:d("MODIFIER")||""});continue}y("END")}return o}function ha(t,e){var n=[],s=Hn(t,n,e);return ga(s,n,e)}function ga(t,e,n){n===void 0&&(n={});var s=n.decode,r=s===void 0?function(a){return a}:s;return function(a){var i=t.exec(a);if(!i)return!1;for(var o=i[0],c=i.index,l=Object.create(null),p=function(y){if(i[y]===void 0)return"continue";var f=e[y-1];f.modifier==="*"||f.modifier==="+"?l[f.name]=i[y].split(f.prefix+f.suffix).map(function(b){return r(b,f)}):l[f.name]=r(i[y],f)},d=1;d<i.length;d++)p(d);return{path:o,index:c,params:l}}}function $e(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function Fn(t){return t&&t.sensitive?"":"i"}function ya(t,e){if(!e)return t;for(var n=/\((?:\?<(.*?)>)?(?!\?)/g,s=0,r=n.exec(t.source);r;)e.push({name:r[1]||s++,prefix:"",suffix:"",modifier:"",pattern:""}),r=n.exec(t.source);return t}function ba(t,e,n){var s=t.map(function(r){return Hn(r,e,n).source});return new RegExp("(?:".concat(s.join("|"),")"),Fn(n))}function va(t,e,n){return wa(ma(t,n),e,n)}function wa(t,e,n){n===void 0&&(n={});for(var s=n.strict,r=s===void 0?!1:s,a=n.start,i=a===void 0?!0:a,o=n.end,c=o===void 0?!0:o,l=n.encode,p=l===void 0?function(E){return E}:l,d=n.delimiter,y=d===void 0?"/#?":d,f=n.endsWith,b=f===void 0?"":f,h="[".concat($e(b),"]|$"),v="[".concat($e(y),"]"),g=i?"^":"",w=0,P=t;w<P.length;w++){var x=P[w];if(typeof x=="string")g+=$e(p(x));else{var j=$e(p(x.prefix)),R=$e(p(x.suffix));if(x.pattern)if(e&&e.push(x),j||R)if(x.modifier==="+"||x.modifier==="*"){var _=x.modifier==="*"?"?":"";g+="(?:".concat(j,"((?:").concat(x.pattern,")(?:").concat(R).concat(j,"(?:").concat(x.pattern,"))*)").concat(R,")").concat(_)}else g+="(?:".concat(j,"(").concat(x.pattern,")").concat(R,")").concat(x.modifier);else{if(x.modifier==="+"||x.modifier==="*")throw new TypeError('Can not repeat "'.concat(x.name,'" without a prefix and suffix'));g+="(".concat(x.pattern,")").concat(x.modifier)}else g+="(?:".concat(j).concat(R,")").concat(x.modifier)}}if(c)r||(g+="".concat(v,"?")),g+=n.endsWith?"(?=".concat(h,")"):"$";else{var I=t[t.length-1],S=typeof I=="string"?v.indexOf(I[I.length-1])>-1:I===void 0;r||(g+="(?:".concat(v,"(?=").concat(h,"))?")),S||(g+="(?=".concat(v,"|").concat(h,")"))}return new RegExp(g,Fn(n))}function Hn(t,e,n){return t instanceof RegExp?ya(t,e):Array.isArray(t)?ba(t,e,n):va(t,e,n)}async function xa(t,e,n,s,r=yn()){const a=t.withConfig({apiVersion:$t});try{const i=new Date(Date.now()+1e3*br),o=`drafts.${r}`,c=Vn(),l=a.patch(o).set({secret:c,source:e,studioUrl:n,userId:s});return await a.transaction().createOrReplace({_id:o,_type:bn}).patch(l).commit({tag:kt}),{secret:c,expiresAt:i}}finally{try{await a.delete({query:vr})}catch(i){console.error("Failed to delete expired secrets",i)}}}function Pa(t){const{draftMode:e,previewMode:n,origin:s=typeof location>"u"?"https://localhost":location.origin}=t,r=(n==null?void 0:n.enable)||(e==null?void 0:e.enable);let{preview:a="/"}=t;const i=new URL(a,s),o=r?new URL(r,s):void 0;return async c=>{try{if(c.previewSearchParam){const p=new URL(c.previewSearchParam,i);p.origin===i.origin&&(a=`${p.pathname}${p.search}`)}}catch{}typeof location<"u"&&location.origin===i.origin&&c.studioBasePath&&(a.startsWith(`${c.studioBasePath}/`)||a===c.studioBasePath)&&(a=t.preview||"/");const l=new URL(a,i);if(o){const p=new URL(o),{searchParams:d}=p;return d.set(It,c.previewUrlSecret),d.set(He,c.studioPreviewPerspective),l.pathname!==p.pathname&&d.set(Ct,`${l.pathname}${l.search}`),p.toString()}return l.toString()}}const Sa=t=>typeof t=="object"&&typeof t.then=="function",et=[];function _a(t,e,n=(s,r)=>s===r){if(t===e)return!0;if(!t||!e)return!1;const s=t.length;if(e.length!==s)return!1;for(let r=0;r<s;r++)if(!n(t[r],e[r]))return!1;return!0}function ja(t,e=null,n=!1,s={}){e===null&&(e=[t]);for(const a of et)if(_a(e,a.keys,a.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(a,"error"))throw a.error;if(Object.prototype.hasOwnProperty.call(a,"response"))return s.lifespan&&s.lifespan>0&&(a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.remove,s.lifespan)),a.response;if(!n)throw a.promise}const r={keys:e,equal:s.equal,remove:()=>{const a=et.indexOf(r);a!==-1&&et.splice(a,1)},promise:(Sa(t)?t:t(...e)).then(a=>{r.response=a,s.lifespan&&s.lifespan>0&&(r.timeout=setTimeout(r.remove,s.lifespan))}).catch(a=>r.error=a)};if(et.push(r),!n)throw r.promise}const Bn=(t,e,n)=>ja(t,e,!1,n);function Ea(t,e){let n=new AbortController,s=[];async function r(i,o){const{result:c,syncTags:l}=await t.fetch(wr,{},{filterResponse:!1,lastLiveEventId:i,tag:"preview-url-secret.fetch-vercel-bypass-protection-secret"});Array.isArray(l)&&(s=l),o.aborted||e(c)}const a=t.live.events().subscribe({next:i=>{i.type==="message"&&(n.abort(),n=new AbortController,i.tags.some(o=>s.includes(o))&&r(i.id,n.signal))},error:i=>console.error(i)});return r(null,n.signal),()=>{a.unsubscribe(),n.abort()}}const Ra=t=>{const e=z.c(3),{comlink:n}=t;let s,r;return e[0]!==n?(s=()=>n.on("visual-editing/features",Ca),r=[n],e[0]=n,e[1]=s,e[2]=r):(s=e[1],r=e[2]),m.useEffect(s,r),null};var Ta=m.memo(Ra);function Ca(){return{features:{optimistic:!0}}}function Kn(t,e){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>{t.apply(t,s)},e)}}const Ia=function(t){const e=z.c(14),{comlink:n,children:s}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={},e[0]=r):r=e[0];const a=m.useRef(r);let i,o;e[1]!==n?(i=()=>n==null?void 0:n.on("visual-editing/shared-state",()=>({state:a.current})),o=[n],e[1]=n,e[2]=i,e[3]=o):(i=e[2],o=e[3]),m.useEffect(i,o);let c;e[4]!==n?(c=(v,g)=>{a.current[v]=g,n==null||n.post("presentation/shared-state",{key:v,value:g})},e[4]=n,e[5]=c):c=e[5];const l=c;let p;e[6]!==n?(p=v=>{n==null||n.post("presentation/shared-state",{key:v}),delete a.current[v]},e[6]=n,e[7]=p):p=e[7];const d=p;let y,f;e[8]!==d||e[9]!==l?(f={removeValue:d,setValue:l},e[8]=d,e[9]=l,e[10]=f):f=e[10],y=f;const b=y;let h;return e[11]!==s||e[12]!==b?(h=u.jsx(Dr.Provider,{value:b,children:s}),e[11]=s,e[12]=b,e[13]=h):h=e[13],h},Aa=fe.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,Bt=function(t){const e=z.c(15),{children:n,defaultSize:s,id:r,minWidth:a,maxWidth:i,order:o}=t,c=s===void 0?null:s,l=o===void 0?0:o,p=m.useContext(Ot);if(p===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:d,registerElement:y,unregisterElement:f}=p;let b;e[0]!==d||e[1]!==r?(b=d(r),e[0]=d,e[1]=r,e[2]=b):b=e[2];const h=b;let v,g;e[3]!==c||e[4]!==r||e[5]!==i||e[6]!==a||e[7]!==l||e[8]!==y||e[9]!==f?(v=()=>(y(r,{id:r,type:"panel",defaultSize:c,maxWidth:i??null,minWidth:a??0,order:l}),()=>{f(r)}),g=[r,c,l,i,a,y,f],e[3]=c,e[4]=r,e[5]=i,e[6]=a,e[7]=l,e[8]=y,e[9]=f,e[10]=v,e[11]=g):(v=e[10],g=e[11]),m.useLayoutEffect(v,g);let w;return e[12]!==n||e[13]!==h?(w=u.jsx(Aa,{style:h,children:n}),e[12]=n,e[13]=h,e[14]=w):w=e[14],w},Gn="presentation/panels",Xn=()=>JSON.parse(localStorage.getItem(Gn)||"{}"),$a=t=>{localStorage.setItem(Gn,JSON.stringify(t))},Jn=t=>t.map(e=>[e.id,e.order].join(":")).join(",");function ka(){const t=z.c(1);let e;const n=Oa,s=Ma;let r;if(t[0]===Symbol.for("react.memo_cache_sentinel")){const a=Kn(s,100);r={get:n,set:s,setDebounced:a},t[0]=r}else r=t[0];return e=r,e}function Ma(t,e){const n=Xn(),s=Jn(t),r={...n,[s]:e};$a(r)}function Oa(t){const e=Xn(),n=Jn(t);return Array.isArray(e[n])&&e[n].some(La)?void 0:e[n]}function La(t){return t===null}function Et(t,e,n){const{maxWidth:s,minWidth:r}=t,a=s==null?100:s/n*100,i=r/n*100;return Math.min(a,Math.max(i,e))}function za(t,e,n,s,r,a){const{panels:i,widths:o}=r,{widths:c}=a,l=c||o,p=[...l];{const b=t<0?s:n,h=i.findIndex(w=>w.id===b.id),v=l[h],g=Et(b,v+Math.abs(t),e);if(v===g)return l;t=t<0?v-g:g-v}let d=0,y=t<0?n:s,f=i.findIndex(b=>b.id===y.id);for(;;){const b=i[f],h=l[f],v=Math.abs(t)-Math.abs(d),g=Et(b,h-v,e);if(h!==g&&(d+=h-g,p[f]=g,d.toPrecision(10).localeCompare(Math.abs(t).toPrecision(10),void 0,{numeric:!0})>=0))break;if(t<0){if(--f<0)break}else if(++f>=i.length)break}return d===0?l:(y=t<0?s:n,f=i.findIndex(b=>b.id===y.id),p[f]=l[f]+d,p)}function Da(t,e,n){if(t.length===1)return"100";const s=t.findIndex(a=>a.id===e),r=n[s];return r==null?"0":r.toPrecision(10)}function an(t,e,n=0,s=null){const r=t.clientX,a=(s||e.getBoundingClientRect()).left;return r-a-n}function vt(t){return t.type==="panel"}function on(t){return t.type==="resizer"}function cn(t){return Array.from(t.values()).sort(({order:e},{order:n})=>e==null&&n==null?0:e==null?-1:n==null?1:e-n)}function ln(t,e,n){const s=e.reduce((i,o)=>i+o,0),r=[...e].map(i=>i/s*100);let a=0;for(let i=0;i<t.length;i++){const o=t[i],c=r[i],l=Et(o,c,n);c!=l&&(a+=c-l,r[i]=l)}if(a.toFixed(3)!=="0.000")for(let i=0;i<t.length;i++){const o=t[i];let{maxWidth:c,minWidth:l}=o;l=l/n*100,c!=null&&(c=c/n*100);const p=Math.min(c??100,Math.max(l,r[i]+a));if(p!==r[i]&&(a-=p-r[i],r[i]=p,Math.abs(a).toFixed(3)==="0.000"))break}return r}function Ua(t){let e=t.length,n=100;const s=t.map(a=>a.defaultSize?(n-=a.defaultSize,e-=1,a.defaultSize):null),r=n/e;return s.map(a=>a===null?r:a)}const Wa=fe.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,Na=function(t){const e=z.c(46),{children:n}=t,s=m.useRef(null);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=new Map,e[0]=r):r=e[0];const[a,i]=m.useState(r);let o,c;e[1]!==a?(c=cn(a).filter(vt),e[1]=a,e[2]=c):c=e[2],o=c;const l=o;let p;e[3]===Symbol.for("react.memo_cache_sentinel")?(p=[],e[3]=p):p=e[3];const[d,y]=m.useState(p),[f,b]=m.useState(null);let h;e[4]!==a||e[5]!==l||e[6]!==d?(h={elements:a,panels:l,widths:d},e[4]=a,e[5]=l,e[6]=d,e[7]=h):h=e[7];const v=m.useRef(h);let g;e[8]!==f||e[9]!==l||e[10]!==d?(g=H=>({flexGrow:Da(l,H,d),pointerEvents:f===null?void 0:"none"}),e[8]=f,e[9]=l,e[10]=d,e[11]=g):g=e[11];const w=g;let P;e[12]===Symbol.for("react.memo_cache_sentinel")?(P=(H,V)=>{i(B=>{if(B.has(H))return B;const K=new Map(B);return K.set(H,V),K})},e[12]=P):P=e[12];const x=P;let j;e[13]===Symbol.for("react.memo_cache_sentinel")?(j=H=>{i(V=>{if(!V.has(H))return V;const B=new Map(V);return B.delete(H),B})},e[13]=j):j=e[13];const R=j;let _;e[14]===Symbol.for("react.memo_cache_sentinel")?(_={containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]},e[14]=_):_=e[14];const I=m.useRef(_);let S;e[15]!==a?(S=(H,V)=>{const B=cn(a),K=B.findIndex(ee=>ee.id===H),ae=a.get(H);if(!ae||!on(ae))return;const G=ae.el.current;G&&(I.current={resizerIndex:K,panelBefore:B.reduce((ee,Y,ie)=>vt(Y)&&ie<K?Y:ee,null),panelAfter:B.reduce((ee,Y,ie)=>ee===null&&vt(Y)&&ie>K?Y:ee,null),containerWidth:window.innerWidth,startX:V.pageX,dragOffset:an(V,G),resizerRect:G.getBoundingClientRect(),widths:v.current.widths},b(H))},e[15]=a,e[16]=S):S=e[16];const E=S;let C;e[17]===Symbol.for("react.memo_cache_sentinel")?(C=()=>{b(null)},e[17]=C):C=e[17];const $=C;let A;e[18]!==a?(A=(H,V)=>{V.preventDefault(),V.stopPropagation();const{containerWidth:B,dragOffset:K,panelBefore:ae,panelAfter:G,resizerRect:ee}=I.current;if(ae==null||G==null)return;const Y=a.get(H);if(!Y||!on(Y))return;const ie=Y.el.current;if(!ie)return;const oe=an(V,ie,K,ee);if(oe===0)return;const{widths:he}=v.current,ge=s.current.getBoundingClientRect(),je=oe/ge.width*100,me=za(je,B,ae,G,v.current,I.current);he.some((Ee,ye)=>Ee!==me[ye])&&y(me)},e[18]=a,e[19]=A):A=e[19];const T=A;let k,U;e[20]!==a||e[21]!==l||e[22]!==d?(k=()=>{v.current.elements=a,v.current.panels=l,v.current.widths=d},U=[a,l,d],e[20]=a,e[21]=l,e[22]=d,e[23]=k,e[24]=U):(k=e[23],U=e[24]),m.useLayoutEffect(k,U);const O=ka();let L,W;e[25]!==l||e[26]!==O?(L=()=>{const{widths:H}=v.current;if(H.length===l.length)return;const V=O.get(l);if(V){const K=ln(l,V,window.innerWidth);y(K);return}const B=Ua(l);y(B)},W=[O,l],e[25]=l,e[26]=O,e[27]=L,e[28]=W):(L=e[27],W=e[28]),m.useLayoutEffect(L,W);let J,F;e[29]!==l||e[30]!==O||e[31]!==d?(J=()=>{d.length&&O.setDebounced(l,d)},F=[O,l,d],e[29]=l,e[30]=O,e[31]=d,e[32]=J,e[33]=F):(J=e[32],F=e[33]),m.useEffect(J,F);let Q,se;e[34]===Symbol.for("react.memo_cache_sentinel")?(Q=()=>{const H=new ResizeObserver(()=>{const{panels:V,widths:B}=v.current,K=ln(V,B,window.innerWidth);B.some((ae,G)=>ae!==K[G])&&y(K)});return H.observe(s.current),()=>{H.disconnect()}},se=[],e[34]=Q,e[35]=se):(Q=e[34],se=e[35]),m.useLayoutEffect(Q,se);let ce,D;e[36]!==f||e[37]!==T||e[38]!==w||e[39]!==E?(D={activeResizer:f,drag:T,getPanelStyle:w,registerElement:x,startDragging:E,stopDragging:$,unregisterElement:R},e[36]=f,e[37]=T,e[38]=w,e[39]=E,e[40]=D):D=e[40],ce=D;const Z=ce;let le;e[41]!==n?(le=u.jsx(Wa,{ref:s,children:n}),e[41]=n,e[42]=le):le=e[42];let ue;return e[43]!==Z||e[44]!==le?(ue=u.jsx(Ot.Provider,{value:Z,children:le}),e[43]=Z,e[44]=le,e[45]=ue):ue=e[45],ue};function Kt(t){const e=z.c(37);let n,s,r,a,i;e[0]!==t?({children:n,message:s,onRetry:a,onContinueAnyway:r,...i}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=a,e[5]=i):(n=e[1],s=e[2],r=e[3],a=e[4],i=e[5]);const{t:o}=be(ve);let c;e[6]!==o?(c=o("error-card.retry-button.text"),e[6]=o,e[7]=c):c=e[7];let l;e[8]!==a||e[9]!==c?(l=u.jsx(_e,{mode:"ghost",onClick:a,text:c}),e[8]=a,e[9]=c,e[10]=l):l=e[10];const p=l;let d;e[11]!==o?(d=o("error-card.continue-button.text"),e[11]=o,e[12]=d):d=e[12];let y;e[13]!==r||e[14]!==d?(y=u.jsx(_e,{mode:"ghost",tone:"critical",onClick:r,text:d}),e[13]=r,e[14]=d,e[15]=y):y=e[15];const f=y;let b;e[16]!==o?(b=o("error-card.title"),e[16]=o,e[17]=b):b=e[17];let h;e[18]!==b?(h=u.jsx(X,{size:1,weight:"semibold",children:b}),e[18]=b,e[19]=h):h=e[19];let v;e[20]!==s?(v=u.jsx(X,{muted:!0,size:1,children:s}),e[20]=s,e[21]=v):v=e[21];let g;e[22]!==h||e[23]!==v?(g=u.jsxs(Le,{space:3,children:[h,v]}),e[22]=h,e[23]=v,e[24]=g):g=e[24];let w;e[25]!==f||e[26]!==r||e[27]!==a||e[28]!==p?(w=a&&r?u.jsxs(Br,{space:2,children:[p,f]}):a?u.jsx(pe,{children:p}):r?u.jsx(pe,{children:f}):null,e[25]=f,e[26]=r,e[27]=a,e[28]=p,e[29]=w):w=e[29];let P;e[30]!==n||e[31]!==g||e[32]!==w?(P=u.jsx(re,{align:"center",height:"fill",justify:"center",children:u.jsx(Kr,{padding:4,sizing:"border",width:0,children:u.jsxs(Le,{space:4,children:[g,n,w]})})}),e[30]=n,e[31]=g,e[32]=w,e[33]=P):P=e[33];let x;return e[34]!==i||e[35]!==P?(x=u.jsx(de,{height:"fill",...i,children:P}),e[34]=i,e[35]=P,e[36]=x):x=e[36],x}function qa(t={}){const e=Object.entries(t).map(([n,s])=>`${n}=${s}`).join("&");return e.length?`?${e}`:""}function Va(t){const e=["comment","inspect","instruction","pathKey","rev","since","template","view"],n=Object.entries(t).filter(([s])=>e.includes(s)).reduce((s,[r,a])=>a==null?s:{...s,[r]:a},{});return qa(n)}const Fa=m.forwardRef(function(t,e){const n=z.c(11);let s,r;n[0]!==t?({searchParams:r,...s}=t,n[0]=t,n[1]=s,n[2]=r):(s=n[1],r=n[2]);let a;n[3]!==r?(a=Object.entries(r),n[3]=r,n[4]=a):a=n[4];let i;n[5]!==a?(i={type:void 0,_searchParams:a},n[5]=a,n[6]=i):i=n[6];let o;return n[7]!==e||n[8]!==s||n[9]!==i?(o=u.jsx(ut,{...s,ref:e,state:i,title:void 0}),n[7]=e,n[8]=s,n[9]=i,n[10]=o):o=n[10],o}),Ha=m.forwardRef(function(t,e){const n=z.c(15);let s,r,a,i;if(n[0]!==t){const{documentId:p,documentType:d,parentRefPath:y,template:f,searchParams:b,...h}=t;s=p,r=d,i=b,a=h,n[0]=t,n[1]=s,n[2]=r,n[3]=a,n[4]=i}else s=n[1],r=n[2],a=n[3],i=n[4];let o;n[5]!==i?(o=Object.entries(i),n[5]=i,n[6]=o):o=n[6];let c;n[7]!==s||n[8]!==r||n[9]!==o?(c={id:s,type:r,_searchParams:o},n[7]=s,n[8]=r,n[9]=o,n[10]=c):c=n[10];let l;return n[11]!==e||n[12]!==a||n[13]!==c?(l=u.jsx(ut,{...a,ref:e,state:c,title:void 0}),n[11]=e,n[12]=a,n[13]=c,n[14]=l):l=n[14],l});function Qn(t){const e=z.c(26),{children:n,onStructureParams:s,structureParams:r,searchParams:a,refs:i}=t,{state:o,resolvePathFromState:c}=Mt();let l;e[0]!==o._searchParams?(l=Object.fromEntries(o._searchParams||[]),e[0]=o._searchParams,e[1]=l):l=e[1];const p=xn(l);let d;e[2]!==c||e[3]!==p||e[4]!==o?(d=I=>{const S=c(o),E=Va({...p,...I});return`${S}${E}`},e[2]=c,e[3]=p,e[4]=o,e[5]=d):d=e[5];const y=d;let f,b;e[6]===Symbol.for("react.memo_cache_sentinel")?(b={},e[6]=b):b=e[6];const h=r;let v;e[7]===Symbol.for("react.memo_cache_sentinel")?(v=[],e[7]=v):v=e[7];let g;e[8]!==i||e[9]!==a?(g=I=>{const{childId:S,...E}=I,C=i==null?void 0:i.find($=>$._id===S||lt($._id)===S);return C?u.jsx(ut,{...E,state:{id:S,type:C._type,_searchParams:Object.entries(a)}}):u.jsx("div",{...E})},e[8]=i,e[9]=a,e[10]=g):g=e[10];let w,P;e[11]!==a?(w=I=>u.jsx(Fa,{...I,searchParams:a}),P=I=>u.jsx(Ha,{...I,searchParams:a}),e[11]=a,e[12]=w,e[13]=P):(w=e[12],P=e[13]);let x;e[14]!==s?(x=I=>{s({...I,inspect:I.inspect??void 0})},e[14]=s,e[15]=x):x=e[15];let j;e[16]!==y||e[17]!==h||e[18]!==g||e[19]!==w||e[20]!==P||e[21]!==x?(j={index:0,groupIndex:0,siblingIndex:0,payload:b,params:h,hasGroupSiblings:!1,groupLength:1,routerPanesState:v,ChildLink:g,BackLink:w,ReferenceChildLink:P,ParameterizedLink:ei,closeCurrentAndAfter:Za,handleEditReference:Ya,replaceCurrent:Qa,closeCurrent:Ja,duplicateCurrent:Xa,setView:Ga,setParams:x,setPayload:Ka,navigateIntent:Ba,createPathWithParams:y},e[16]=y,e[17]=h,e[18]=g,e[19]=w,e[20]=P,e[21]=x,e[22]=j):j=e[22],f=j;const R=f;let _;return e[23]!==n||e[24]!==R?(_=u.jsx(ms.Provider,{value:R,children:n}),e[23]=n,e[24]=R,e[25]=_):_=e[25],_}function Ba(t,e,n){console.warn("navigateIntent",t,e,n)}function Ka(t){console.warn("setPayload",t)}function Ga(t){console.warn("setView",t)}function Xa(t){console.warn("duplicateCurrent",t)}function Ja(){console.warn("closeCurrent")}function Qa(t){console.warn("replaceCurrent",t)}function Ya(t){console.warn("handleEditReference",t)}function Za(){console.warn("closeCurrentAndAfter")}function ei(){throw new Error("ParameterizedLink not implemented")}const ti=fe(kn)`
  height: 100%;
`,ni=fe(re)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,ri=fe(st)`
  white-space: pre-wrap;
`;function si(t){var S,E,C,$;const e=z.c(33),{mainDocumentState:n,onStructureParams:s,searchParams:r,refs:a}=t,{t:i}=be(ve),{devMode:o}=Lt();let c,l;if(e[0]!==((S=n==null?void 0:n.document)==null?void 0:S._id)||e[1]!==a){let A;e[3]!==((E=n==null?void 0:n.document)==null?void 0:E._id)?(A=T=>{var k;return lt(T._id)!==((k=n==null?void 0:n.document)==null?void 0:k._id)},e[3]=(C=n==null?void 0:n.document)==null?void 0:C._id,e[4]=A):A=e[4],l=a.filter(A).map(ii),e[0]=($=n==null?void 0:n.document)==null?void 0:$._id,e[1]=a,e[2]=l}else l=e[2];c=l;const p=c;let d,y;e[5]!==p?(y={filter:"_id in $ids",params:{ids:p}},e[5]=p,e[6]=y):y=e[6];let f;e[7]!==i?(f=i("document-list-pane.document-list.title"),e[7]=i,e[8]=f):f=e[8];let b;e[9]!==y||e[10]!==f?(b={id:"$root",options:y,schemaTypeName:"",title:f,type:"documentList"},e[9]=y,e[10]=f,e[11]=b):b=e[11],d=b;const h=d,[v,g]=m.useState(null);let w;e[12]===Symbol.for("react.memo_cache_sentinel")?(w=()=>g(null),e[12]=w):w=e[12];const P=w,[x]=m.useState(ai);let j;e[13]===Symbol.for("react.memo_cache_sentinel")?(j=()=>g(null),e[13]=j):j=e[13];let R;if(e[14]!==a?(R=[a],e[14]=a,e[15]=R):R=e[15],m.useEffect(j,R),v){let A;e[16]!==i?(A=i("document-list-pane.error.text"),e[16]=i,e[17]=A):A=e[17];let T;e[18]!==o||e[19]!==v||e[20]!==i?(T=o&&u.jsx(de,{overflow:"auto",padding:3,radius:2,tone:"critical",children:u.jsxs(Le,{space:3,children:[u.jsx(rt,{muted:!0,size:0,children:i("presentation-error.label")}),u.jsx(ri,{size:1,children:v.error.message})]})}),e[18]=o,e[19]=v,e[20]=i,e[21]=T):T=e[21];let k;return e[22]!==T||e[23]!==A?(k=u.jsx(Kt,{flex:1,message:A,onRetry:P,children:T}),e[22]=T,e[23]=A,e[24]=k):k=e[24],k}let _;e[25]!==h?(_=u.jsx(ni,{direction:"column",flex:1,children:u.jsx(xs,{index:0,itemId:"$root",pane:h,paneKey:"$root"})}),e[25]=h,e[26]=_):_=e[26];let I;return e[27]!==s||e[28]!==a||e[29]!==r||e[30]!==x||e[31]!==_?(I=u.jsx($n,{onCatch:g,children:u.jsx(ti,{children:u.jsx(An,{children:u.jsx(Qn,{onStructureParams:s,structureParams:x,searchParams:r,refs:a,children:_})})})}),e[27]=s,e[28]=a,e[29]=r,e[30]=x,e[31]=_,e[32]=I):I=e[32],I}function ai(){return{}}function ii(t){return lt(t._id)}const oi=fe(st)`
  white-space: pre-wrap;
`;function ci(t){const e=z.c(35),{documentId:n,documentType:s,onFocusPath:r,onStructureParams:a,searchParams:i,structureParams:o}=t,{template:c,templateParams:l}=o,{t:p}=be(ve),{devMode:d}=Lt();let y,f;e[0]!==l?(f=fs(l),e[0]=l,e[1]=f):f=e[1];let b;e[2]!==n||e[3]!==s||e[4]!==f||e[5]!==c?(b={id:n,type:s,template:c,templateParameters:f},e[2]=n,e[3]=s,e[4]=f,e[5]=c,e[6]=b):b=e[6];let h;e[7]!==n||e[8]!==b?(h={id:n,options:b,title:"",type:"document"},e[7]=n,e[8]=b,e[9]=h):h=e[9],y=h;const v=y,[g,w]=m.useState(null);let P;e[10]===Symbol.for("react.memo_cache_sentinel")?(P=()=>w(null),e[10]=P):P=e[10];const x=P;let j;e[11]===Symbol.for("react.memo_cache_sentinel")?(j=()=>{w(null)},e[11]=j):j=e[11];let R;if(e[12]!==n||e[13]!==s||e[14]!==o?(R=[n,s,o],e[12]=n,e[13]=s,e[14]=o,e[15]=R):R=e[15],m.useEffect(j,R),g){let C;e[16]!==p?(C=p("document-pane.error.text"),e[16]=p,e[17]=C):C=e[17];let $;e[18]!==d||e[19]!==g||e[20]!==p?($=d&&u.jsx(de,{overflow:"auto",padding:3,radius:2,tone:"critical",children:u.jsxs(Le,{space:3,children:[u.jsx(rt,{muted:!0,size:0,children:p("presentation-error.label")}),u.jsx(oi,{size:1,children:g.error.message})]})}),e[18]=d,e[19]=g,e[20]=p,e[21]=$):$=e[21];let A;return e[22]!==C||e[23]!==$?(A=u.jsx(Kt,{flex:1,message:C,onRetry:x,children:$}),e[22]=C,e[23]=$,e[24]=A):A=e[24],A}let _;e[25]===Symbol.for("react.memo_cache_sentinel")?(_={height:"100%"},e[25]=_):_=e[25];let I;e[26]===Symbol.for("react.memo_cache_sentinel")?(I=u.jsx(wn,{}),e[26]=I):I=e[26];let S;e[27]!==r||e[28]!==v?(S=u.jsx(m.Suspense,{fallback:I,children:u.jsx(hs,{paneKey:"document",index:1,itemId:"document",pane:v,onFocusPath:r})}),e[27]=r,e[28]=v,e[29]=S):S=e[29];let E;return e[30]!==a||e[31]!==i||e[32]!==o||e[33]!==S?(E=u.jsx($n,{onCatch:w,children:u.jsx(kn,{style:_,children:u.jsx(Qn,{searchParams:i,onStructureParams:a,structureParams:o,children:S})})}),e[30]=a,e[31]=i,e[32]=o,e[33]=S,e[34]=E):E=e[34],E}function li(t){const e=z.c(7),{documentId:n,documentType:s,onFocusPath:r,onStructureParams:a,searchParams:i,structureParams:o}=t;let c;return e[0]!==n||e[1]!==s||e[2]!==r||e[3]!==a||e[4]!==i||e[5]!==o?(c=u.jsx(An,{children:u.jsx(ci,{documentId:n,documentType:s,onFocusPath:r,onStructureParams:a,searchParams:i,structureParams:o})}),e[0]=n,e[1]=s,e[2]=r,e[3]=a,e[4]=i,e[5]=o,e[6]=c):c=e[6],c}function ui(t,e){const n=z.c(6),s=ps();let r;n[0]===Symbol.for("react.memo_cache_sentinel")?(r={},n[0]=r):r=n[0];const[a,i]=m.useState(r);let o,c;return n[1]!==t||n[2]!==s||n[3]!==e?(o=()=>{if(!e)return;const l=gs(s,e,t,"").subscribe(p=>{i(p)});return()=>{l==null||l.unsubscribe()}},c=[s,e,t],n[1]=t,n[2]=s,n[3]=e,n[4]=o,n[5]=c):(o=n[4],c=n[5]),m.useEffect(o,c),a}function di(t){var _,I,S,E,C,$,A,T;const e=z.c(39),{documentId:n,documentType:s,mainDocumentState:r,onFocusPath:a,onStructureParams:i,refs:o,searchParams:c,structureParams:l}=t,{t:p}=be(ve),d=ss();let y;e[0]!==((_=r==null?void 0:r.document)==null?void 0:_._id)||e[1]!==((I=r==null?void 0:r.document)==null?void 0:I._type)||e[2]!==c?(y=k=>{var U,O;return u.jsx(ut,{...k,state:{id:(U=r==null?void 0:r.document)==null?void 0:U._id,type:(O=r==null?void 0:r.document)==null?void 0:O._type,_searchParams:Object.entries(c)}})},e[0]=(S=r==null?void 0:r.document)==null?void 0:S._id,e[1]=(E=r==null?void 0:r.document)==null?void 0:E._type,e[2]=c,e[3]=y):y=e[3];const f=y;let b,h;e[4]!==((C=r==null?void 0:r.document)==null?void 0:C._type)||e[5]!==d?(h=d.get((($=r==null?void 0:r.document)==null?void 0:$._type)||"shoe"),e[4]=(A=r==null?void 0:r.document)==null?void 0:A._type,e[5]=d,e[6]=h):h=e[6],b=h;const v=b,g=ui(((T=r==null?void 0:r.document)==null?void 0:T._id)||"",v);let w;e:{if(!(r!=null&&r.document)){w=null;break e}const k=r.document;let U;e[7]!==g.draft||e[8]!==g.published||e[9]!==k?(U=as({value:k,published:g.published,draft:g.draft}),e[7]=g.draft,e[8]=g.published,e[9]=k,e[10]=U):U=e[10];let O;e[11]!==p?(O=p("main-document.label"),e[11]=p,e[12]=O):O=e[12];let L;e[13]!==O?(L=u.jsx(de,{padding:1,radius:2,shadow:1,children:u.jsx(X,{muted:!0,size:0,weight:"medium",children:O})}),e[13]=O,e[14]=L):L=e[14];let W;e[15]!==v||e[16]!==U||e[17]!==L?(W=u.jsx(is,{...U,schemaType:v,status:L}),e[15]=v,e[16]=U,e[17]=L,e[18]=W):W=e[18],w=W}const P=w;if(n&&s){let k;return e[19]!==n||e[20]!==s||e[21]!==a||e[22]!==i||e[23]!==c||e[24]!==l?(k=u.jsx(li,{documentId:n,documentType:s,onFocusPath:a,onStructureParams:i,searchParams:c,structureParams:l}),e[19]=n,e[20]=s,e[21]=a,e[22]=i,e[23]=c,e[24]=l,e[25]=k):k=e[25],k}let x;e[26]!==f||e[27]!==r||e[28]!==P||e[29]!==p?(x=r&&u.jsx(de,{padding:3,tone:r.document?"inherit":"caution",children:r.document?u.jsx(os,{__unstable_focusRing:!0,as:f,"data-as":"a",radius:2,sizing:"border",tone:"inherit",children:P}):u.jsx(de,{padding:2,radius:2,tone:"inherit",children:u.jsxs(re,{gap:3,children:[u.jsx(pe,{flex:"none",children:u.jsx(X,{size:1,children:u.jsx(cs,{})})}),u.jsx(pe,{flex:1,children:u.jsx(X,{size:1,children:u.jsx(ls,{t:p,i18nKey:"main-document.missing.text",components:{Code:"code"},values:{path:r.path}})})})]})})}),e[26]=f,e[27]=r,e[28]=P,e[29]=p,e[30]=x):x=e[30];let j;e[31]!==r||e[32]!==i||e[33]!==o||e[34]!==c?(j=u.jsx(si,{mainDocumentState:r,onStructureParams:i,searchParams:c,refs:o}),e[31]=r,e[32]=i,e[33]=o,e[34]=c,e[35]=j):j=e[35];let R;return e[36]!==x||e[37]!==j?(R=u.jsxs(re,{direction:"column",flex:1,height:"fill",children:[x,j]}),e[36]=x,e[37]=j,e[38]=R):R=e[38],R}function pi(t){const e=z.c(2);let n;e[0]!==t?(n=()=>t||ca(),e[0]=t,e[1]=n):n=e[1];const[s]=m.useState(n);return s}const fi=fe.div`
  position: relative;
`,mi=fe.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:t})=>t?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:t})=>!t&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,Yn=function(t){const e=z.c(27),{id:n,order:s,disabled:r}=t,a=r===void 0?!1:r,i=m.useRef(null),o=m.useContext(Ot);if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");const c=pi(n),{activeResizer:l,drag:p,startDragging:d,stopDragging:y,registerElement:f,unregisterElement:b}=o,h=l===c;if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");let v;e[0]!==c||e[1]!==d?(v=T=>{d(c,T.nativeEvent)},e[0]=c,e[1]=d,e[2]=v):v=e[2];const g=v;let w;e[3]!==p||e[4]!==c?(w=T=>{p(c,T)},e[3]=p,e[4]=c,e[5]=w):w=e[5];const P=w;let x;e[6]!==y?(x=()=>{i.current.blur(),y()},e[6]=y,e[7]=x):x=e[7];const j=x;let R,_;e[8]!==a||e[9]!==h||e[10]!==P||e[11]!==j?(R=()=>{if(!h||a)return;const T=function(){const k=document.body.style,U=document.documentElement.style,{cursor:O}=U,{userSelect:L}=k;return U.cursor="ew-resize",k.userSelect="none",()=>{O?U.cursor=O:U.removeProperty("cursor"),L?k.userSelect=L:k.removeProperty("user-select")}}();return window.addEventListener("mousemove",P),window.addEventListener("mouseup",j),window.addEventListener("contextmenu",j),()=>{T(),window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",j),window.removeEventListener("contextmenu",j)}},_=[a,h,P,j],e[8]=a,e[9]=h,e[10]=P,e[11]=j,e[12]=R,e[13]=_):(R=e[12],_=e[13]),m.useEffect(R,_);let I,S;e[14]!==c||e[15]!==s||e[16]!==f||e[17]!==b?(I=()=>(f(c,{id:c,order:s,type:"resizer",el:i}),()=>{b(c)}),S=[c,s,f,b],e[14]=c,e[15]=s,e[16]=f,e[17]=b,e[18]=I,e[19]=S):(I=e[18],S=e[19]),m.useLayoutEffect(I,S);let E,C;e[20]===Symbol.for("react.memo_cache_sentinel")?(C=u.jsx("span",{}),E=u.jsx("span",{}),e[20]=E,e[21]=C):(E=e[20],C=e[21]);let $;e[22]!==a?($=u.jsxs(mi,{$disabled:a,children:[C,E]}),e[22]=a,e[23]=$):$=e[23];let A;return e[24]!==g||e[25]!==$?(A=u.jsx(fi,{onMouseDown:g,ref:i,children:$}),e[24]=g,e[25]=$,e[26]=A):A=e[26],A},hi=t=>{const e=z.c(8),{documentId:n,setDisplayedDocument:s,getCommentIntent:r}=t;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=u.jsx(Yn,{order:4}),e[0]=a):a=e[0];let i;e[1]!==r||e[2]!==t.children?(i=u.jsx(qr,{getIntent:r,children:t.children}),e[1]=r,e[2]=t.children,e[3]=i):i=e[3];let o;return e[4]!==n||e[5]!==s||e[6]!==i?(o=u.jsxs(u.Fragment,{children:[a,u.jsx(Bt,{id:"content",minWidth:325,order:5,children:u.jsx(_s,{documentId:n,setDisplayedDocument:s,children:i})})]}),e[4]=n,e[5]=s,e[6]=i,e[7]=o):o=e[7],o},gi=t=>{const e=z.c(14),{documentId:n,documentsOnPage:s,documentType:r,getCommentIntent:a,mainDocumentState:i,onFocusPath:o,onStructureParams:c,searchParams:l,setDisplayedDocument:p,structureParams:d}=t;let y;e[0]!==n||e[1]!==r||e[2]!==s||e[3]!==i||e[4]!==o||e[5]!==c||e[6]!==l||e[7]!==d?(y=u.jsx(di,{documentId:n,documentType:r,mainDocumentState:i,onFocusPath:o,onStructureParams:c,refs:s,searchParams:l,structureParams:d}),e[0]=n,e[1]=r,e[2]=s,e[3]=i,e[4]=o,e[5]=c,e[6]=l,e[7]=d,e[8]=y):y=e[8];let f;return e[9]!==n||e[10]!==a||e[11]!==p||e[12]!==y?(f=u.jsx(hi,{documentId:n,getCommentIntent:a,setDisplayedDocument:p,children:y}),e[9]=n,e[10]=a,e[11]=p,e[12]=y,e[13]=f):f=e[13],f},yi=function(t){const e=z.c(5),{children:n,navigate:s}=t;let r;e[0]!==s?(r=(o,c)=>{s((c===void 0?void 0:c)||{},o?{preview:o}:{})},e[0]=s,e[1]=r):r=e[1];const a=r;let i;return e[2]!==n||e[3]!==a?(i=u.jsx(Lr.Provider,{value:a,children:n}),e[2]=n,e[3]=a,e[4]=i):i=e[4],i};function bi(t,e){const n=z.c(9);let s;n[0]!==e||n[1]!==t?(s=()=>JSON.parse(localStorage.getItem(t)??JSON.stringify(e)),n[0]=e,n[1]=t,n[2]=s):s=n[2];const[r,a]=m.useState(s);let i,o;n[3]!==t||n[4]!==r?(i=()=>{localStorage.setItem(t,JSON.stringify(r))},o=[t,r],n[3]=t,n[4]=r,n[5]=i,n[6]=o):(i=n[5],o=n[6]),m.useEffect(i,o);let c;return n[7]!==r?(c=[r,a],n[7]=r,n[8]=c):c=n[8],c}function vi(t){const e=z.c(11),{unstable_navigator:n}=t,s=!!(n!=null&&n.component),[r,a]=bi("presentation/navigator",s),i=s?r:!1;let o;e:{if(!s){o=void 0;break e}let f;e[0]!==a?(f=()=>a(wi),e[0]=a,e[1]=f):f=e[1],o=f}const c=o;let l;e[2]!==i||e[3]!==n?(l=function(){return u.jsx(u.Fragment,{children:i&&u.jsx(Pi,{...n})})},e[2]=i,e[3]=n,e[4]=l):l=e[4];const p=l;let d;e[5]!==i||e[6]!==c?(d={navigatorEnabled:i,toggleNavigator:c},e[5]=i,e[6]=c,e[7]=d):d=e[7];let y;return e[8]!==p||e[9]!==d?(y=[d,p],e[8]=p,e[9]=d,e[10]=y):y=e[10],y}function wi(t){return!t}function xi(t){const e=z.c(11),{minWidth:n,maxWidth:s,component:r}=t,a=n!=null&&s!=null&&n===s;let i;e[0]!==r?(i=u.jsx(r,{}),e[0]=r,e[1]=i):i=e[1];let o;e[2]!==s||e[3]!==n||e[4]!==i?(o=u.jsx(Bt,{id:"navigator",minWidth:n,maxWidth:s,order:1,children:i}),e[2]=s,e[3]=n,e[4]=i,e[5]=o):o=e[5];let c;e[6]!==a?(c=u.jsx(Yn,{order:2,disabled:a}),e[6]=a,e[7]=c):c=e[7];let l;return e[8]!==o||e[9]!==c?(l=u.jsxs(u.Fragment,{children:[o,c]}),e[8]=o,e[9]=c,e[10]=l):l=e[10],l}const Pi=m.memo(xi),Si=function(t){const e=z.c(3),{children:n,params:s}=t;let r;r=s;const a=r;let i;return e[0]!==n||e[1]!==a?(i=u.jsx(zr.Provider,{value:a,children:n}),e[0]=n,e[1]=a,e[2]=i):i=e[2],i},_i=function(t){const e=z.c(10),{children:n,devMode:s,name:r,navigate:a,params:i,searchParams:o,structureParams:c}=t;let l,p;e[0]!==s||e[1]!==r||e[2]!==a||e[3]!==i||e[4]!==o||e[5]!==c?(p={devMode:s,name:r,navigate:a,params:i,searchParams:o,structureParams:c},e[0]=s,e[1]=r,e[2]=a,e[3]=i,e[4]=o,e[5]=c,e[6]=p):p=e[6],l=p;const d=l;let y;return e[7]!==n||e[8]!==d?(y=u.jsx(Or.Provider,{value:d,children:n}),e[7]=n,e[8]=d,e[9]=y):y=e[9],y};function Gt(t){return Array.isArray(t)?t.join(","):t}const ji=Je.create(fe.iframe`
  box-shadow: 0 0 0 1px var(--card-border-color);
  border: 0;
  max-height: 100%;
  width: 100%;
  view-transition-class: presentation-tool-iframe;
`),Ei=fe(pe)`
  position: absolute;
  inset: 0;
  background: transparent;
`,Ri=m.forwardRef(function(t,e){const n=z.c(16),{animate:s,initial:r,onLoad:a,preventClick:i,src:o,variants:c,style:l}=t,p=`presentation-tool-iframe-${m.useId().replace(/[^a-zA-Z0-9-_]/g,"_")}`;let d;n[0]!==l||n[1]!==p?(d={...l,viewTransitionName:p},n[0]=l,n[1]=p,n[2]=d):d=n[2];let y;n[3]!==s||n[4]!==r||n[5]!==a||n[6]!==e||n[7]!==o||n[8]!==d||n[9]!==c?(y=u.jsx(ji,{style:d,animate:s,initial:r,onLoad:a,ref:e,src:o,variants:c}),n[3]=s,n[4]=r,n[5]=a,n[6]=e,n[7]=o,n[8]=d,n[9]=c,n[10]=y):y=n[10];let f;n[11]!==i?(f=i&&u.jsx(Ei,{}),n[11]=i,n[12]=f):f=n[12];let b;return n[13]!==y||n[14]!==f?(b=u.jsxs(u.Fragment,{children:[y,f]}),n[13]=y,n[14]=f,n[15]=b):b=n[15],b});function Ti(t){const e=z.c(16),{openPopup:n,previewLocationOrigin:s,previewLocationRoute:r}=t,{t:a}=be(ve);let i;e[0]!==n?(i=h=>{h.preventDefault(),n(h.currentTarget.href)},e[0]=n,e[1]=i):i=e[1];const o=i;let c;e[2]!==a?(c=a("share-url.menu-item.open.text"),e[2]=a,e[3]=c):c=e[3];let l;e[4]!==c?(l=u.jsx(X,{size:1,children:c}),e[4]=c,e[5]=l):l=e[5];let p;e[6]===Symbol.for("react.memo_cache_sentinel")?(p=["bottom-start"],e[6]=p):p=e[6];let d;e[7]!==a?(d=a("share-url.menu-item.open.text"),e[7]=a,e[8]=d):d=e[8];const y=`${s}${r}`;let f;e[9]!==o||e[10]!==d||e[11]!==y?(f=u.jsx(_e,{as:"a","aria-label":d,icon:ys,mode:"bleed",href:y,rel:"opener",target:"_blank",tooltipProps:null,onClick:o}),e[9]=o,e[10]=d,e[11]=y,e[12]=f):f=e[12];let b;return e[13]!==l||e[14]!==f?(b=u.jsx(Ve,{animate:!0,content:l,fallbackPlacements:p,placement:"bottom",portal:!0,children:f}),e[13]=l,e[14]=f,e[15]=b):b=e[15],b}const Ci=function(t){var L;const e=z.c(27),{fontSize:n,onChange:s,origin:r,padding:a,prefix:i,suffix:o,value:c}=t,l=n===void 0?1:n,p=a===void 0?3:a,{t:d}=be(ve),{basePath:y}=((L=_n())==null?void 0:L.activeWorkspace)||{},f=y===void 0?"/":y,b=m.useRef(null),[h,v]=m.useState(void 0),[g,w]=m.useState(void 0);let P;e[0]===Symbol.for("react.memo_cache_sentinel")?(P=W=>{v(W.currentTarget.value)},e[0]=P):P=e[0];const x=P;let j;e[1]!==f||e[2]!==s||e[3]!==r||e[4]!==h||e[5]!==d?(j=W=>{var J;if(W.key==="Enter"){if(h===void 0)return;const F=h.startsWith("/")||h===""?`${r}${h}`:h;if(!F.startsWith(`${r}/`)&&F!==r){w(d("preview-location-input.error",{origin:r,context:"missing-origin"}));return}if(!r&&(F.startsWith(`${f}/`)||F===f)){w(d("preview-location-input.error",{basePath:f,context:"same-base-path"}));return}const Q=F===r?`${r}/`:F;w(void 0),v(void 0),s(Q.slice(r.length)),(J=b.current)==null||J.blur()}W.key==="Escape"&&(w(void 0),v(void 0))},e[1]=f,e[2]=s,e[3]=r,e[4]=h,e[5]=d,e[6]=j):j=e[6];const R=j;let _;e[7]===Symbol.for("react.memo_cache_sentinel")?(_=()=>{w(void 0),v(void 0)},e[7]=_):_=e[7];const I=_;let S;e[8]===Symbol.for("react.memo_cache_sentinel")?(S=()=>{w(void 0),v(void 0)},e[8]=S):S=e[8];let E;e[9]!==r||e[10]!==c?(E=[r,c],e[9]=r,e[10]=c,e[11]=E):E=e[11],m.useEffect(S,E);let C,$;e[12]===Symbol.for("react.memo_cache_sentinel")?($={icon:bs},e[12]=$):$=e[12],C=$;const A=g?C:void 0;let T;e[13]!==r||e[14]!==c?(T=()=>{w(void 0),v(r+c)},e[13]=r,e[14]=c,e[15]=T):T=e[15];let k;e[16]===Symbol.for("react.memo_cache_sentinel")?(k={zIndex:1},e[16]=k):k=e[16];const U=h===void 0?`${r}${c}`:h;let O;return e[17]!==g||e[18]!==l||e[19]!==R||e[20]!==p||e[21]!==i||e[22]!==o||e[23]!==A||e[24]!==T||e[25]!==U?(O=u.jsx(u.Fragment,{children:u.jsx(ds,{clearButton:A,customValidity:g,fontSize:l,onBlur:I,onClear:T,onChange:x,onKeyDownCapture:R,padding:p,prefix:i,style:k,radius:2,ref:b,space:p,suffix:o,value:U})}),e[17]=g,e[18]=l,e[19]=R,e[20]=p,e[21]=i,e[22]=o,e[23]=A,e[24]=T,e[25]=U,e[26]=O):O=e[26],O},Ii=m.lazy(()=>ke(()=>import("./QRCodeSVG-i9cPYuqV.js"),__vite__mapDeps([0,1]))),Rt=24,Ai=16,$i=224,ki=fe(vs)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: ${Rt}px;
  width: ${Rt}px;
`,Mi=Je.create(nt),Oi=Je.create(X),Li=Je.create(ki),Zn=m.memo(function(t){const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:n,initialUrl:s,previewLocationRoute:r,perspective:a}=t,{t:i}=be(ve),{push:o}=vn(),c=Ge({apiVersion:Xe}),l=zt(),[p,d]=m.useState(!0),[y,f]=m.useState(!1),[b,h]=m.useState(!1),[v,g]=m.useState(null),w=y||b||p,P=m.useMemo(()=>v?ua(s,v,r,Gt(a)):null,[s,a,r,v]),[x,j]=m.useState(null);if(x)throw x;const R=m.useCallback(()=>{o({closable:!0,status:"warning",title:i("share-preview-menu.error_toggle-sharing",{context:"toggle-sharing"})})},[o,i]),_=m.useCallback(async()=>{try{h(!0),await pa(c,"@sanity/presentation",typeof window>"u"?"":location.href,l==null?void 0:l.id),g(null)}catch(E){j(E)}finally{h(!1)}},[c,l==null?void 0:l.id]),I=m.useCallback(async()=>{try{f(!0);const E=await da(c,"@sanity/presentation",typeof window>"u"?"":location.href,l==null?void 0:l.id);g(E.secret)}catch(E){j(E)}finally{f(!1)}},[c,l==null?void 0:l.id]),S=m.useCallback(()=>{try{if(!P)throw new Error("No URL to copy");navigator.clipboard.writeText(P.toString()),o({closable:!0,status:"success",title:i("share-url.clipboard.status",{context:"success"})})}catch(E){j(E)}},[o,i,P]);return m.useEffect(()=>{let E=new AbortController,C=[];async function $(T,k){const{result:U,syncTags:O}=await c.fetch(us,{},{filterResponse:!1,lastLiveEventId:T,tag:"presentation.fetch-shared-access-secret"});Array.isArray(O)&&(C=O),k.aborted||g(U)}const A=c.live.events().subscribe({next:T=>{T.type==="message"&&(E.abort(),E=new AbortController,T.tags.some(k=>C.includes(k))&&$(T.id,E.signal))},error:j});return $(null,E.signal).finally(()=>d(!1)),()=>{A.unsubscribe(),E.abort()}},[c]),u.jsx(Gr,{button:u.jsx(_e,{"aria-label":i("preview-frame.share-button.aria-label"),icon:es,mode:"bleed",tooltipProps:null}),id:"share-menu",menu:u.jsx(Xr,{style:{maxWidth:248},padding:n?void 0:0,children:n?u.jsxs(u.Fragment,{children:[u.jsx("label",{style:{cursor:"pointer"},children:u.jsxs(Jr,{columns:2,rows:2,gapX:3,gapY:1,style:{justifyContent:"center",alignItems:"center",gridTemplateColumns:"min-content 1fr",gridTemplateRows:"min-content"},paddingTop:3,paddingX:3,children:[u.jsx(Ve,{animate:!0,content:u.jsx(X,{size:1,children:i("share-preview-menu.toggle-button.tooltip",{context:P?"disable":"enable"})}),fallbackPlacements:["bottom-start"],placement:"bottom",portal:!0,children:u.jsx(Rn,{checked:y||P!==null&&!b,readOnly:y||b,indeterminate:p,onChange:e?P?_:I:R})}),u.jsx(X,{size:1,weight:"medium",children:i("share-preview-menu.toggle-button.label",{context:"first-line"})}),u.jsx("span",{}),u.jsx(X,{muted:!0,size:1,children:i("share-preview-menu.toggle-button.label",{context:"second-line"})})]})}),u.jsx(pe,{padding:3,paddingTop:2,children:u.jsxs(Le,{space:3,children:[u.jsx(de,{tone:w||!P?"transparent":void 0,style:{position:"relative",aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:u.jsx(En,{children:w?u.jsx(Mi,{muted:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}):P?u.jsx(u.Fragment,{children:u.jsxs(m.Suspense,{fallback:u.jsx(nt,{}),children:[u.jsx(Ii,{title:i("share-preview-menu.qr-code.title",{url:P.toString()}),value:P.toString(),size:$i,color:"var(--card-fg-color)",logoSize:Rt+Ai}),u.jsx(Li,{initial:{opacity:-.5},animate:{opacity:1.5},exit:{opacity:0}})]})}):u.jsx(Oi,{muted:!0,size:1,style:{maxWidth:"100px",textWrap:"pretty",textAlign:"center"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i("share-preview-menu.qr-code.placeholder")})})}),u.jsx(X,{muted:!0,size:1,children:i("share-preview-menu.qr-code.instructions")})]})}),u.jsx(Qr,{}),u.jsx(Yr,{disabled:!P||b,icon:Zr,onClick:S,text:i("share-preview-menu.copy-url.text")})]}):u.jsx(de,{padding:2,tone:"caution",radius:3,children:u.jsx(X,{style:{textWrap:"pretty"},children:i("share-preview-menu.error",{context:"missing-grants"})})})}),popover:{constrainSize:!0,placement:"bottom",portal:!0}})});Zn.displayName="Memo(SharePreviewMenu)";const zi=t=>{const e=z.c(97),{canSharePreviewAccess:n,canToggleSharePreviewAccess:s,canUseSharedPreviewAccess:r,dispatch:a,iframe:i,iframeRef:o,initialUrl:c,navigatorEnabled:l,onPathChange:p,onRefresh:d,openPopup:y,overlaysConnection:f,perspective:b,previewUrl:h,setViewport:v,targetOrigin:g,toggleNavigator:w,toggleOverlay:P,viewport:x,visualEditing:j}=t,{overlaysEnabled:R}=j,{t:_}=be(ve);let I;e[0]!==v||e[1]!==x?(I=()=>v(x==="desktop"?"mobile":"desktop"),e[0]=v,e[1]=x,e[2]=I):I=e[2];const S=I;let E;E=g===location.origin?"":g;const C=E;let $;e[3]!==a||e[4]!==o.current||e[5]!==d||e[6]!==h||e[7]!==g?($=()=>{d(()=>{o.current&&(a({type:jn}),Object.assign(o.current,{src:`${g}${h||"/"}`}))})},e[3]=a,e[4]=o.current,e[5]=d,e[6]=h,e[7]=g,e[8]=$):$=e[8];const A=$;let T;const k=new URL(h||"/",g),{pathname:U,search:O}=la(k);T=`${U}${O}`;const L=T;let W;e[9]===Symbol.for("react.memo_cache_sentinel")?(W={width:"100%"},e[9]=W):W=e[9];let J;e[10]!==l||e[11]!==_||e[12]!==w?(J=w&&u.jsx(_e,{"aria-label":_("preview-frame.navigator.toggle-button.aria-label"),icon:Vr,mode:"bleed",onClick:w,selected:l,tooltipProps:{content:u.jsx(X,{size:1,children:_("preview-frame.navigator.toggle-button.tooltip")}),fallbackPlacements:["bottom-start"],placement:"bottom"}}),e[10]=l,e[11]=_,e[12]=w,e[13]=J):J=e[13];let F;e[14]===Symbol.for("react.memo_cache_sentinel")?(F={whiteSpace:"nowrap"},e[14]=F):F=e[14];const Q=R?"disable":"enable";let se;e[15]!==_||e[16]!==Q?(se=_("preview-frame.overlay.toggle-button.tooltip",{context:Q}),e[15]=_,e[16]=Q,e[17]=se):se=e[17];let ce;e[18]!==se?(ce=u.jsx(pe,{padding:1,children:u.jsx(X,{size:1,children:se})}),e[18]=se,e[19]=ce):ce=e[19];let D;e[20]===Symbol.for("react.memo_cache_sentinel")?(D=u.jsx(pe,{paddingY:1,children:u.jsx(ts,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})}),e[20]=D):D=e[20];let Z;e[21]!==ce?(Z=u.jsxs(re,{align:"center",style:F,children:[ce,D]}),e[21]=ce,e[22]=Z):Z=e[22];let le;e[23]===Symbol.for("react.memo_cache_sentinel")?(le=["bottom-start"],e[23]=le):le=e[23];let ue;e[24]===Symbol.for("react.memo_cache_sentinel")?(ue={lineHeight:0,borderRadius:999,userSelect:"none"},e[24]=ue):ue=e[24];const H=R?"transparent":void 0;let V;e[25]===Symbol.for("react.memo_cache_sentinel")?(V={margin:-4},e[25]=V):V=e[25];const B=i.status==="loading"||f!=="connected";let K;e[26]!==R||e[27]!==B||e[28]!==P?(K=u.jsx("div",{style:V,children:u.jsx(Rn,{checked:R,onChange:P,disabled:B})}),e[26]=R,e[27]=B,e[28]=P,e[29]=K):K=e[29];const ae=!R;let G;e[30]!==_?(G=_("preview-frame.overlay.toggle-button.text"),e[30]=_,e[31]=G):G=e[31];let ee;e[32]!==ae||e[33]!==G?(ee=u.jsx(pe,{children:u.jsx(X,{muted:ae,size:1,weight:"medium",children:G})}),e[32]=ae,e[33]=G,e[34]=ee):ee=e[34];let Y;e[35]!==K||e[36]!==ee?(Y=u.jsxs(re,{align:"center",gap:3,children:[K,ee]}),e[35]=K,e[36]=ee,e[37]=Y):Y=e[37];let ie;e[38]!==H||e[39]!==Y?(ie=u.jsx(de,{as:"label",flex:"none",padding:3,marginX:1,style:ue,tone:H,children:Y}),e[38]=H,e[39]=Y,e[40]=ie):ie=e[40];let oe;e[41]!==Z||e[42]!==ie?(oe=u.jsx(Ve,{animate:!0,content:Z,fallbackPlacements:le,placement:"bottom",portal:!0,children:ie}),e[41]=Z,e[42]=ie,e[43]=oe):oe=e[43];let he;e[44]!==i.status||e[45]!==_?(he=i.status==="loaded"?_("preview-frame.refresh-button.tooltip"):_("preview-frame.status",{context:i.status}),e[44]=i.status,e[45]=_,e[46]=he):he=e[46];let ge;e[47]!==he?(ge=u.jsx(X,{size:1,children:he}),e[47]=he,e[48]=ge):ge=e[48];let je;e[49]===Symbol.for("react.memo_cache_sentinel")?(je=["bottom-end"],e[49]=je):je=e[49];let me;e[50]!==_?(me=_("preview-frame.refresh-button.aria-label"),e[50]=_,e[51]=me):me=e[51];const Ee=i.status==="reloading"||i.status==="refreshing";let ye;e[52]!==A||e[53]!==me||e[54]!==Ee?(ye=u.jsx(_e,{"aria-label":me,icon:ns,mode:"bleed",loading:Ee,onClick:A,tooltipProps:null}),e[52]=A,e[53]=me,e[54]=Ee,e[55]=ye):ye=e[55];let Re;e[56]!==ge||e[57]!==ye?(Re=u.jsx(pe,{padding:1,children:u.jsx(Ve,{animate:!0,content:ge,fallbackPlacements:je,placement:"bottom",portal:!0,children:ye})}),e[56]=ge,e[57]=ye,e[58]=Re):Re=e[58];let we;e[59]!==y||e[60]!==C||e[61]!==L?(we=u.jsx(pe,{padding:1,children:u.jsx(Ti,{openPopup:y,previewLocationOrigin:C,previewLocationRoute:L})}),e[59]=y,e[60]=C,e[61]=L,e[62]=we):we=e[62];let Te;e[63]!==p||e[64]!==C||e[65]!==L||e[66]!==Re||e[67]!==we?(Te=u.jsx(pe,{flex:1,children:u.jsx(Ci,{prefix:Re,onChange:p,origin:C,suffix:we,value:L})}),e[63]=p,e[64]=C,e[65]=L,e[66]=Re,e[67]=we,e[68]=Te):Te=e[68];const ze=x==="desktop"?"narrow":"full";let Ce;e[69]!==_||e[70]!==ze?(Ce=_("preview-frame.viewport-button.tooltip",{context:ze}),e[69]=_,e[70]=ze,e[71]=Ce):Ce=e[71];let Ie;e[72]!==Ce?(Ie=u.jsx(X,{size:1,children:Ce}),e[72]=Ce,e[73]=Ie):Ie=e[73];let Me;e[74]===Symbol.for("react.memo_cache_sentinel")?(Me=["bottom-start"],e[74]=Me):Me=e[74];let xe;e[75]!==_?(xe=_("preview-frame.viewport-button.aria-label"),e[75]=_,e[76]=xe):xe=e[76];const De=x==="desktop"?Fr:Hr;let Pe;e[77]!==xe||e[78]!==De||e[79]!==S?(Pe=u.jsx(_e,{"aria-label":xe,icon:De,mode:"bleed",onClick:S,tooltipProps:null}),e[77]=xe,e[78]=De,e[79]=S,e[80]=Pe):Pe=e[80];let Se;e[81]!==Ie||e[82]!==Pe?(Se=u.jsx(re,{align:"center",flex:"none",gap:1,children:u.jsx(Ve,{animate:!0,content:Ie,fallbackPlacements:Me,placement:"bottom",portal:!0,children:Pe})}),e[81]=Ie,e[82]=Pe,e[83]=Se):Se=e[83];let M;e[84]!==n||e[85]!==s||e[86]!==r||e[87]!==c||e[88]!==b||e[89]!==L?(M=n&&u.jsx(re,{align:"center",flex:"none",gap:1,children:u.jsx(Zn,{canToggleSharePreviewAccess:s,canUseSharedPreviewAccess:r,previewLocationRoute:L,initialUrl:c,perspective:b})}),e[84]=n,e[85]=s,e[86]=r,e[87]=c,e[88]=b,e[89]=L,e[90]=M):M=e[90];let q;return e[91]!==oe||e[92]!==Te||e[93]!==Se||e[94]!==M||e[95]!==J?(q=u.jsxs(re,{align:"center",gap:1,paddingX:1,style:W,children:[J,oe,Te,Se,M]}),e[91]=oe,e[92]=Te,e[93]=Se,e[94]=M,e[95]=J,e[96]=q):q=e[96],q};function Di(t){var l;const e=z.c(7),n=Ui,s=(l=t.options)==null?void 0:l.component;let r;e[0]!==s||e[1]!==t?(r=s?u.jsx(s,{...t,renderDefault:n}):n(t),e[0]=s,e[1]=t,e[2]=r):r=e[2];const a=r;let i;e[3]===Symbol.for("react.memo_cache_sentinel")?(i={position:"relative"},e[3]=i):i=e[3];let o;e[4]===Symbol.for("react.memo_cache_sentinel")?(o={minHeight:0},e[4]=o):o=e[4];let c;return e[5]!==a?(c=u.jsx(de,{flex:"none",padding:2,borderBottom:!0,style:i,children:u.jsx(re,{align:"center",style:o,children:a})}),e[5]=a,e[6]=c):c=e[6],c}function Ui(t){return u.jsx(zi,{...t})}function Wi(t){const e=z.c(2);let n;return e[0]!==t?(n=()=>u.jsx(Di,{...t}),e[0]=t,e[1]=n):n=e[1],n}const wt=Je.create(re),er=m.memo(m.forwardRef(function(t,e){const{dispatch:n,iframe:s,header:r,initialUrl:a,loadersConnection:i,overlaysConnection:o,perspective:c,viewport:l,vercelProtectionBypass:p}=t,[d,y]=m.useState(null),f=Gt(d===null?c:d),b=m.useMemo(()=>{const D=new URL(a);return D.searchParams.get(He)||D.searchParams.set(He,f),(p||D.searchParams.get(Ne))&&D.searchParams.set(At,"samesitenone"),p&&!D.searchParams.get(Ne)&&D.searchParams.set(Ne,p),D},[a,f,p]);m.useEffect(()=>{i==="connected"&&y(D=>D===null?c:D)},[i,c]);const{t:h}=be(ve),{devMode:v}=Lt(),g=Ur(),w=m.useRef(null),P=Wi({...t,iframeRef:w,options:r});m.useImperativeHandle(e,()=>w.current);const x=s.status==="loading"||s.status==="reloading",[j,R]=m.useState(!1),_=s.status==="refreshing",[I,S]=m.useState(!1),E=x||_||o==="connecting",C=m.useCallback(()=>{w.current&&(w.current.src=b.toString(),n({type:jn}))},[n,b]),$=m.useCallback(()=>{T(!0)},[]),[A,T]=m.useState(!1),[k,U]=m.useState(!1);m.useEffect(()=>{if(!(x||_)&&(o==="connecting"||o==="reconnecting")){const D=setTimeout(()=>{U(!0)},5e3);return()=>clearTimeout(D)}},[o,x,_]),m.useEffect(()=>{if(!(x||_||!k)){if(o==="connected"&&(S(!1),U(!1),R(!1),T(!1)),o==="connecting"){const D=setTimeout(()=>{R(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},Qt);return()=>clearTimeout(D)}if(o==="reconnecting"){const D=setTimeout(()=>{R(!0),S(!0)},Qt);return()=>clearTimeout(D)}}},[x,o,_,k]);const O=m.useCallback(()=>{n({type:Sn})},[n]);m.useEffect(()=>{if(!w.current)return;const D=w.current;function Z(){D===document.activeElement&&D.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))}return window.addEventListener("blur",Z),()=>{window.removeEventListener("blur",Z)}},[]);const L=m.useMemo(()=>(x||o==="connecting"&&s.status!=="refreshing")&&!A,[A,s.status,x,o]),W=m.useSyncExternalStore(m.useCallback(()=>()=>{},[]),()=>CSS.supports("(view-transition-name: test)")),J=m.useMemo(()=>[L?"background":"active",x?"reloading":"idle",W?"":l,k&&!A?"timedOut":""],[W,A,x,L,k,l]),[F,Q]=m.useState(l),[se,ce]=m.useState(xt[l]);return m.useEffect(()=>{if(W&&l!==F){const D=()=>{Q(l),ce(xt[l])};!g&&"startViewTransition"in document&&typeof document.startViewTransition=="function"?document.startViewTransition(()=>Wr.flushSync(()=>D())):D()}},[W,g,F,l]),u.jsx(Es,{transition:g?{duration:0}:void 0,children:u.jsxs(Nr,{children:[u.jsx(P,{}),u.jsx(de,{flex:1,tone:"transparent",children:u.jsxs(re,{align:"center",height:"fill",justify:"center",padding:(W?F:l)==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:E?"wait":void 0},children:[u.jsx(En,{children:!I&&!x&&!_&&k&&!A?u.jsx(wt,{initial:"initial",animate:"animate",exit:"exit",variants:un,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:j?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:j?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:u.jsxs(re,{style:{...ct[l]},justify:"center",align:"center",direction:"column",gap:4,children:[j&&u.jsx(_e,{disabled:!0,mode:"ghost",text:h("preview-frame.continue-button.text"),style:{opacity:0}}),u.jsx(de,{radius:2,tone:j?"caution":"inherit",padding:4,shadow:1,children:u.jsxs(re,{justify:"center",align:"center",direction:"column",gap:4,children:[u.jsx(nt,{muted:!0}),u.jsx(X,{muted:!0,size:1,children:j?h("preview-frame.status",{context:"timeout"}):h("preview-frame.status",{context:"connecting"})})]})}),j&&u.jsx(_e,{tone:"critical",onClick:$,text:h("preview-frame.continue-button.text")})]})}):(x||o==="connecting"&&s.status!=="refreshing")&&!A?u.jsx(wt,{initial:"initial",animate:"animate",exit:"exit",variants:un,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:u.jsxs(re,{style:{...ct[l]},justify:"center",align:"center",direction:"column",gap:4,children:[u.jsx(nt,{muted:!0}),u.jsx(X,{muted:!0,size:1,children:h("preview-frame.status",{context:"loading"})})]})}):I&&!A?u.jsx(wt,{initial:"initial",animate:"animate",exit:"exit",variants:Ni,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute"},children:u.jsx(Kt,{flex:1,message:h("preview-frame.connection.error.text"),onRetry:C,onContinueAnyway:$,children:v&&u.jsxs(u.Fragment,{children:[o!=="connected"&&u.jsx(de,{padding:3,radius:2,tone:"critical",children:u.jsxs(Le,{space:3,children:[u.jsx(rt,{muted:!0,size:0,children:h("preview-frame.overlay.connection-status.label")}),u.jsx(st,{size:1,children:h("channel.status",{context:o})})]})}),i!=="connected"&&u.jsx(de,{padding:3,radius:2,tone:"critical",children:u.jsxs(Le,{space:3,children:[u.jsx(rt,{muted:!0,size:0,children:h("preview-frame.loader.connection-status.label")}),u.jsx(st,{size:1,children:h("channel.status",{context:i})})]})})]})})}):null}),u.jsx(Ri,{animate:J,initial:["background"],onLoad:O,preventClick:L,ref:w,src:b.toString(),style:se,variants:xt})]})})]})})}));er.displayName="Memo(ForwardRef(Preview))";const ct={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},un={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},Ni={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},xt={desktop:{...ct.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...ct.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};function qi(){let t=!1;return(...e)=>{t||(console.warn(...e),t=!0)}}const Vi=qi();function Fi(t,e){kr(t);const[n,s]=m.useState({}),[r,a]=m.useState({}),i=m.useRef(""),o=m.useCallback((c,l,p=[])=>{const d=p.filter(y=>"_projectId"in y&&y._projectId?(Vi("Cross dataset references are not supported yet, ignoring source document",y),!1):y);(l==="published"?s:a)(y=>{const f={};for(const h of d)f[h._id]=h;if(i.current!==e.current.url)return i.current=e.current.url,{[c]:f};const b=y[c];return Ss(b,f)?y:{...y,[c]:f}})},[e]);return[m.useMemo(()=>{const c=Object.values(t==="published"?n:r).reduce((l,p)=>(Object.values(p).forEach(d=>{l[d._id]=d}),l),{});return Object.values(c)},[t,r,n]),o]}function tr(t,e){return t instanceof Function?t(e):t}function Hi(t,e){var n;if(t.resolve){const s=(n=t.resolve(e))==null?void 0:n.filter;return s?`// groq
*[${s}][0]{_id, _type}`:void 0}return"type"in t?`// groq
*[_type == "${t.type}"][0]{_id, _type}`:`// groq
*[${tr(t.filter,e)}][0]{_id, _type}`}function Bi(t,e){var n;return t.resolve?((n=t.resolve(e))==null?void 0:n.params)??e.params:"type"in t?{}:tr(t.params,e)??e.params}function Ki(t,e){const n=Array.isArray(t)?t:[t];for(t of n){let s,r=t;if(typeof t=="string")try{const a=new URL(t);s=a.origin,r=a.pathname}catch{}if(!(s&&e.origin!==s))try{const a=ha(r,{decode:decodeURIComponent})(e.pathname);if(a){const{params:i,path:o}=a;return{origin:s,params:i,path:o}}}catch{throw new Error(`"${t}" is not a valid route pattern`)}}}function Gi(t){var f,b;const{navigate:e,navigationHistory:n,path:s,previewUrl:r,resolvers:a=[]}=t,{state:i}=Mt(),o=Ge({apiVersion:Xe}),c=s||((b=(f=i._searchParams)==null?void 0:f.find(([h])=>h==="preview"))==null?void 0:b[1])||"",[l,p]=m.useState(void 0),d=m.useRef(void 0),y=Pn((h,v)=>{var g,w;(!h||d.current!==h._id)&&(p({document:h,path:v.pathname}),d.current=h==null?void 0:h._id,((g=n.at(-1))==null?void 0:g.id)===((w=n.at(-2))==null?void 0:w.id)&&(e==null||e({id:h==null?void 0:h._id,type:h==null?void 0:h._type})))});return m.useEffect(()=>{const h=typeof r=="string"?r:typeof r=="object"&&(r==null?void 0:r.origin)||location.origin,v=new URL(c,h);if(a.length){let g;for(const w of a){const P=Ki(w.route,v);if(P){g={context:P,resolver:w};break}}if(g){const w=Hi(g.resolver,g.context),P=Bi(g.resolver,g.context);if(w){const x=new AbortController,j={perspective:"previewDrafts",signal:x.signal};return o.fetch(w,P,j).then(R=>y(R,v)).catch(R=>{R instanceof Error&&R.name==="AbortError"||(p({document:void 0,path:v.pathname}),d.current=void 0)}),()=>{x.abort()}}}}p(void 0),d.current=void 0},[o,y,r,c,a]),l}const Xi=Tn(Dt(),In(1));Cn(Xi);const Ji=/^([\w-]+):(0|[1-9][0-9]*)$/,Qi=/^([\w-]+):([0-9]+),([0-9]+)$/,Yi=/^([\w-]+):([\w-]+)$/;function Zi(t){const e=[];for(const n of t.split(".")){const s=Ji.exec(n);if(s){e.push(s[1],Number(s[2]));continue}const r=Qi.exec(n);if(r){e.push(r[1],[Number(r[2]),Number(r[3])]);continue}const a=Yi.exec(n);if(a){e.push(a[1],{_key:a[2]});continue}e.push(n)}return e}const dn=Tn(Dt(),In(1));rs({origin:dn,href:dn,data:Cn(ws(Dt(),Ps()))});function eo(t){var n;if(t===void 0)return;const e=(n=decodeURIComponent(t))==null?void 0:n.split(".");return e[0]==="drafts"&&e.shift(),e.join(".")}function to(t){if(t!==void 0)return Ln.toString(Zi(decodeURIComponent(t)))}function no(t){return{id:eo(t.id),path:to(t.path),type:t.type}}function tt(t){return Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0&&e!==""&&e!==null))}function ro({initialPreviewUrl:t,routerNavigate:e,routerState:n,routerSearchParams:s,frameStateRef:r}){const a=m.useMemo(()=>{const{id:d,path:y,type:f}=no(n);return{id:d,type:f,path:y,preview:s.preview||`${t.pathname}${t.search}`,perspective:s.perspective,viewport:s.viewport,inspect:s.inspect,rev:s.rev,since:s.since,template:s.template,templateParams:s.templateParams,view:s.view,pathKey:s.pathKey,instruction:s.instruction,comment:s.comment,changesInspectorTab:s.changesInspectorTab}},[n,s,t]),i=m.useMemo(()=>tt({inspect:a.inspect,path:a.path,rev:a.rev,since:a.since,template:a.template,templateParams:a.templateParams,view:a.view,pathKey:a.pathKey,instruction:a.instruction,comment:a.comment,changesInspectorTab:a.changesInspectorTab}),[a.changesInspectorTab,a.comment,a.inspect,a.instruction,a.path,a.pathKey,a.rev,a.since,a.template,a.templateParams,a.view]),o=m.useMemo(()=>tt({perspective:a.perspective,preview:a.preview,viewport:a.viewport}),[a.perspective,a.preview,a.viewport]),c=m.useRef(n);m.useEffect(()=>{c.current=n},[n]);const[l,p]=m.useState([n]);return{navigate:m.useCallback((d,y={},f)=>{d.id&&(d.id=lt(d.id));const{_searchParams:b,...h}=c.current,v=(b||[]).reduce((x,[j,R])=>(x[j]=R,x),{}),g=tt({...h,...d}),w=tt({...v,...y});h.id!==g.id&&(delete w.template,delete w.templateParams),g._searchParams=Object.entries(w).reduce((x,[j,R])=>[...x,[j,R]],[]);const P=f??w.preview===r.current.url;p(x=>[...x,g]),e(g,{replace:P})},[e,r]),navigationHistory:l,params:a,searchParams:o,structureParams:i}}const so=t=>{const[e,n]=m.useState(()=>new Set),s=m.useCallback(r=>{const a=window.open(r,"_blank");a&&n(i=>new Set(i).add(a))},[]);return m.useEffect(()=>{const r=[];if(e.size&&t)for(const a of e)a&&"closed"in a&&!a.closed&&r.push(t.addTarget(a));return()=>{r.forEach(a=>a())}},[t,e]),m.useEffect(()=>{if(e.size){const r=setInterval(()=>{const a=new Set;for(const i of e)i&&"closed"in i&&i.closed&&a.add(i);a.size&&n(i=>{const o=new Set(i);for(const c of a)o.delete(c);return o})},Mr);return()=>{clearInterval(r)}}},[e]),{popups:e,open:s}};function ao(t,e,n,s,r){var d,y;const a=Ge({apiVersion:Xe}),i=_n(),o=((d=i==null?void 0:i.activeWorkspace)==null?void 0:d.basePath)||"/",c=((y=i==null?void 0:i.activeWorkspace)==null?void 0:y.name)||"default",l=oo(e,o,c,s),p=co(r&&typeof t=="object"||typeof t=="function",l);return Bn(async()=>{if(typeof t=="string"){const b=new URL(t,location.origin);let h=b;try{if(s){const v=new URL(s,b);v.origin===b.origin&&(h=v)}}catch{}return location.origin===h.origin&&(h.pathname.startsWith(`${o}/`)||h.pathname===o)?b:h}const f=await(typeof t=="object"?Pa(t):t)({client:a,previewUrlSecret:p,studioPreviewPerspective:Gt(n),previewSearchParam:s,studioBasePath:o});return new URL(f,location.origin)},[...l,p])}const io=Symbol("sanity/presentation/resolveUUID");function oo(t,e,n,s){const r=z.c(12);let a;r[0]!==s?(a=()=>s||"",r[0]=s,r[1]=a):a=r[1];const[i,o]=m.useState(a),c=m.useRef(0);let l,p;r[2]!==i||r[3]!==s?(l=()=>{if(i&&s)return window.clearTimeout(c.current),()=>{c.current=window.setTimeout(()=>{o("")},100)}},p=[i,s],r[2]=i,r[3]=s,r[4]=l,r[5]=p):(l=r[4],p=r[5]),m.useEffect(l,p);const d=zt();let y;const f=d==null?void 0:d.id;let b;return r[6]!==e||r[7]!==i||r[8]!==f||r[9]!==t||r[10]!==n?(b=["sanity/presentation",e,n,t,f,io,i],r[6]=e,r[7]=i,r[8]=f,r[9]=t,r[10]=n,r[11]=b):b=r[11],y=b,y}function co(t,e){const n=z.c(10);let s;n[0]===Symbol.for("react.memo_cache_sentinel")?(s={apiVersion:Xe},n[0]=s):s=n[0];const r=Ge(s),a=zt(),[i,o]=m.useState("");let c;n[1]!==r||n[2]!==(a==null?void 0:a.id)||n[3]!==e||n[4]!==t||n[5]!==i?(c=t?Bn(async()=>await xa(r,"@sanity/presentation",typeof window>"u"?"":location.href,a==null?void 0:a.id),[...e,i]):null,n[1]=r,n[2]=a==null?void 0:a.id,n[3]=e,n[4]=t,n[5]=i,n[6]=c):c=n[6];const l=c;let p,d;return n[7]!==l?(p=()=>{if(!l)return;const y=setTimeout(()=>{m.startTransition(()=>o(l.expiresAt.toString()))},l.expiresAt.getTime()-Date.now());return()=>clearTimeout(y)},d=[l],n[7]=l,n[8]=p,n[9]=d):(p=n[8],d=n[9]),m.useEffect(p,d),(l==null?void 0:l.secret)||null}function Pt(){const t=z.c(4);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,t[0]=e):e=t[0];const[n,s]=m.useState(e);let r;e:{const l=Array.from(n.values());if(l.find(po)){r="connected";break e}const p=l.filter(uo);if(p.length){r=p.some(lo)?"connecting":"reconnecting";break e}r="idle"}const a=r;let i;t[1]===Symbol.for("react.memo_cache_sentinel")?(i=l=>{s(p=>{var y;const d=new Map(p);if(l.status==="disconnected")d.delete(l.connection);else{const f=((y=d.get(l.connection))==null?void 0:y.hasConnected)||l.status==="connected",b=l.status==="handshaking"?"connecting":l.status;d.set(l.connection,{status:b,hasConnected:f})}return d})},t[1]=i):i=t[1];const o=i;let c;return t[2]!==a?(c=[a,o],t[2]=a,t[3]=c):c=t[3],c}function lo(t){const{hasConnected:e}=t;return!e}function uo(t){const{status:e}=t;return e==="connecting"}function po(t){const{status:e}=t;return e==="connected"}const fo=m.lazy(()=>ke(()=>import("./LiveQueries-BYKAReo7.js"),__vite__mapDeps([2,1,3]))),mo=m.lazy(()=>ke(()=>import("./PostMessageDocuments-BBiwck0x.js"),__vite__mapDeps([4,1]))),ho=m.lazy(()=>ke(()=>import("./PostMessageRefreshMutations-C2tmjLrr.js"),__vite__mapDeps([5,1]))),go=m.lazy(()=>ke(()=>import("./PostMessagePerspective-DrTvN2UK.js"),__vite__mapDeps([6,1]))),yo=m.lazy(()=>ke(()=>import("./PostMessagePreviewSnapshots-DL-hoesY.js"),__vite__mapDeps([7,1]))),bo=m.lazy(()=>ke(()=>import("./PostMessageSchema-OvzjbWyW.js"),__vite__mapDeps([8,1]))),vo=m.lazy(()=>ke(()=>import("./PostMessageTelemetry-D1melqOg.js"),__vite__mapDeps([9,1]))),wo=fe(re)`
  overflow-x: auto;
`;function xo(t){var Me,xe,De,Pe,Se;const{canCreateUrlPreviewSecrets:e,canToggleSharePreviewAccess:n,canUseSharedPreviewAccess:s,tool:r,vercelProtectionBypass:a}=t,i=(Me=r.options)==null?void 0:Me.components,o=(xe=r.options)==null?void 0:xe.previewUrl,c=r.name||Pr,{unstable_navigator:l,unstable_header:p}=i||{},{navigate:d,state:y}=Mt(),f=xn(Object.fromEntries(y._searchParams||[])),{perspectiveStack:b,selectedPerspectiveName:h="previewDrafts",selectedReleaseId:v}=Sr(),g=v?b:h,w=ao(o||"/",c,g,f.preview||null,e),P=m.useMemo(()=>o&&typeof o=="object"&&"draftMode"in o&&o.draftMode?(console.warn("previewUrl.draftMode is deprecated, use previewUrl.previewMode instead"),o.draftMode.shareAccess!==!1):o&&typeof o=="object"&&"previewMode"in o&&o.previewMode?o.previewMode.shareAccess!==!1:!1,[o]),[x]=m.useState(()=>{var q;const M=(q=r.options)==null?void 0:q.devMode;return typeof M=="function"?M():typeof M=="boolean"?M:typeof window<"u"&&window.location.hostname==="localhost"}),j=m.useMemo(()=>w.origin,[w.origin]),R=m.useRef(null),[_,I]=m.useState(),[S,E]=m.useState(null),C=m.useRef({title:void 0,url:void 0}),{navigate:$,navigationHistory:A,params:T,searchParams:k,structureParams:U}=ro({initialPreviewUrl:w,routerNavigate:d,routerState:y,routerSearchParams:f,frameStateRef:C}),O=m.useMemo(()=>Kn($,50),[$]),[L,W]=m.useReducer(_r,{},jr),J=m.useMemo(()=>T.viewport?"mobile":"desktop",[T.viewport]),[F,Q]=Fi(g,C),se=Er(),ce=Rr(),D=Gi({navigate:$,navigationHistory:A,path:T.preview,previewUrl:(De=r.options)==null?void 0:De.previewUrl,resolvers:(Se=(Pe=r.options)==null?void 0:Pe.resolve)==null?void 0:Se.mainDocuments}),[Z,le]=Pt(),[ue,H]=Pt(),[V,B]=Pt(),{open:K}=so(_),ae=L.iframe.status==="loading";m.useEffect(()=>{var N;const M=(N=R.current)==null?void 0:N.contentWindow;if(!M||ae)return;const q=Ys({targetOrigin:j});return q.addTarget(M),I(q),()=>{q.destroy(),I(void 0)}},[j,ae]);const G=Pn((M,q,N)=>O(M,q,N));m.useEffect(()=>{if(!_)return;const M=_.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},ot().provide({actors:rn()}));M.on("visual-editing/focus",N=>{"id"in N&&G({type:N.type,id:N.id,path:N.path})}),M.on("visual-editing/navigate",N=>{const{title:nr,url:Qe}=N;if(C.current.url!==Qe)try{const[rr,sr]=Qe.split("?"),Ye=new URLSearchParams(sr);Ye.delete(Ne),Ye.delete(At),G({},{preview:`${rr}${Ye.size>0?"?":""}${Ye}`})}catch{G({},{preview:Qe})}C.current={title:nr,url:Qe}}),M.on("visual-editing/meta",N=>{C.current.title=N.title}),M.on("visual-editing/toggle",N=>{W({type:Tr,enabled:N.enabled})}),M.on("visual-editing/documents",N=>{Q("visual-editing",N.perspective,N.documents)}),M.on("visual-editing/refreshing",N=>{N.source==="manual"?clearTimeout(we.current):N.source==="mutation"&&W({type:Jt})}),M.on("visual-editing/refreshed",()=>{W({type:Sn})}),M.onStatus(le);const q=M.start();return E(M),()=>{q(),E(null)}},[_,G,Q,le,j]),m.useEffect(()=>{if(!_)return;const M=_.createChannel({name:"presentation",connectTo:"preview-kit",heartbeat:!0},ot().provide({actors:rn()}));return M.onStatus(B),M.on("preview-kit/documents",q=>{q.projectId===se&&q.dataset===ce&&Q("preview-kit",q.perspective,q.documents)}),M.start()},[_,ce,se,Q,B,j]);const ee=m.useCallback(M=>{O({path:Ln.toString(M)},{},!0)},[O]),Y=m.useCallback(M=>{const q=new URL(M,w.origin),N=q.pathname+q.search;q.origin===w.origin&&N!==T.preview&&O({},{preview:N})},[w,T,O]),ie=m.useCallback(M=>{O({},M)},[O]);m.useEffect(()=>{T.id&&T.path?S==null||S.post("presentation/focus",{id:T.id,path:T.path}):S==null||S.post("presentation/blur")},[T.id,T.path,S]),m.useEffect(()=>{C.current.url&&T.preview&&C.current.url!==T.preview&&(C.current.url=T.preview,Z!=="connected"&&R.current?R.current.src=`${j}${T.preview}`:S==null||S.post("presentation/navigate",{url:T.preview,type:"replace"}))},[Z,j,T.preview,S]);const oe=m.useCallback(()=>S==null?void 0:S.post("presentation/toggle-overlay"),[S]),[he,ge]=m.useState(null);m.useEffect(()=>{const M=N=>{pn(N)&&oe()},q=N=>{pn(N)&&oe(),So(["mod","\\"],N)&&oe()};return window.addEventListener("keydown",q),window.addEventListener("keyup",M),()=>{window.removeEventListener("keydown",q),window.removeEventListener("keyup",M)}},[oe]);const[je,me]=m.useState(null),[{navigatorEnabled:Ee,toggleNavigator:ye},Re]=vi({unstable_navigator:l}),we=m.useRef(void 0),Te=m.useCallback(M=>{if(W({type:Jt}),S){we.current=window.setTimeout(M,300),S.post("presentation/refresh",{source:"manual",livePreviewEnabled:V==="connected"||ue==="connected"});return}M()},[ue,V,S]),ze=Cr(),Ce=m.useCallback(({id:M,type:q,path:N})=>{if(C.current.url)return{title:C.current.title||C.current.url,name:"edit",params:{id:M,path:N,type:q,inspect:Ar,workspace:ze.name,mode:Ir,preview:T.preview}}},[T.preview,ze.name]),Ie=m.useCallback(M=>{O({},{viewport:M==="desktop"?void 0:"mobile"},!0)},[O]);return u.jsxs(u.Fragment,{children:[u.jsx(_i,{devMode:x,name:c,navigate:O,params:T,searchParams:k,structureParams:U,children:u.jsx(yi,{navigate:O,children:u.jsx(Si,{params:T,children:u.jsx(Ia,{comlink:S,children:u.jsx(wo,{height:"fill",children:u.jsxs(Na,{children:[u.jsx(Re,{}),u.jsx(Bt,{id:"preview",minWidth:325,defaultSize:Ee?50:75,order:3,children:u.jsx(re,{direction:"column",flex:1,height:"fill",ref:me,children:u.jsx($r,{element:je,children:u.jsx(er,{canSharePreviewAccess:P,canToggleSharePreviewAccess:n,canUseSharedPreviewAccess:s,dispatch:W,header:p,iframe:L.iframe,initialUrl:w,loadersConnection:ue,navigatorEnabled:Ee,onPathChange:Y,onRefresh:Te,openPopup:K,overlaysConnection:Z,previewUrl:T.preview,perspective:g,ref:R,setViewport:Ie,targetOrigin:j,toggleNavigator:ye,toggleOverlay:oe,viewport:J,visualEditing:L.visualEditing,vercelProtectionBypass:a},j)})})}),u.jsx(gi,{documentId:T.id,documentsOnPage:F,documentType:T.type,getCommentIntent:Ce,mainDocumentState:D,onFocusPath:ee,onStructureParams:ie,searchParams:k,setDisplayedDocument:ge,structureParams:U})]})})})})})}),u.jsxs(m.Suspense,{children:[_&&u.jsx(fo,{controller:_,perspective:g,liveDocument:he,onDocumentsOnPage:Q,onLoadersConnection:H}),S&&T.id&&T.type&&u.jsx(ho,{comlink:S,id:T.id,type:T.type,loadersConnection:ue,previewKitConnection:V}),S&&u.jsx(bo,{comlink:S,perspective:g}),S&&F.length>0&&u.jsx(yo,{comlink:S,perspective:g,refs:F}),S&&u.jsx(mo,{comlink:S,perspective:g}),S&&u.jsx(Ta,{comlink:S}),S&&u.jsx(go,{comlink:S,perspective:g}),S&&u.jsx(vo,{comlink:S})]})]})}function pn(t){return t.key==="Alt"}const Po=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),fn={alt:"altKey",ctrl:"ctrlKey",mod:Po?"metaKey":"ctrlKey",shift:"shiftKey"};function So(t,e){return t.every(n=>fn[n]?e[fn[n]]:e.key===n.toUpperCase())}function _o(){const t=z.c(7);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e={apiVersion:Xe},t[0]=e):e=t[0];const n=Ge(e),[s,r]=m.useReducer(jo,"loading"),[a,i]=m.useState(null);let o,c;t[1]!==n?(o=()=>{const p=Ea(n,d=>{i(d),r()});return()=>p()},c=[n],t[1]=n,t[2]=o,t[3]=c):(o=t[2],c=t[3]),m.useEffect(o,c);let l;return t[4]!==s||t[5]!==a?(l=[a,s],t[4]=s,t[5]=a,t[6]=l):l=t[6],l}function jo(){return"ready"}function Eo(t){const e=z.c(17),{t:n}=be(ve),{previewUrl:s}=t.tool.options??{},{push:r}=vn(),a=typeof s=="object"||typeof s=="function",i=xr(),[o,c]=m.useState(null),[l,p]=m.useState(null),[d,y]=m.useState(null),[f,b]=m.useState(null);let h,v;e[0]!==i||e[1]!==a?(h=()=>{if(!a)return;const E=i.checkDocumentPermission("create",{_id:Oe,_type:qe}).subscribe(c),C=i.checkDocumentPermission("update",{_id:Oe,_type:qe}).subscribe(p),$=i.checkDocumentPermission("read",{_id:Oe,_type:qe}).subscribe(y),A=i.checkDocumentPermission("create",{_id:`drafts.${yn()}`,_type:bn}).subscribe(b);return()=>{E.unsubscribe(),C.unsubscribe(),$.unsubscribe(),A.unsubscribe()}},v=[i,a],e[0]=i,e[1]=a,e[2]=h,e[3]=v):(h=e[2],v=e[3]),m.useEffect(h,v);const g=f==null?void 0:f.granted;let w,P;e[4]!==g||e[5]!==r||e[6]!==n||e[7]!==a?(w=()=>{if(!a||g!==!1)return;const E=requestAnimationFrame(()=>r({closable:!0,status:"error",duration:3e4,title:n("preview-url-secret.missing-grants")}));return()=>cancelAnimationFrame(E)},P=[g,r,n,a],e[4]=g,e[5]=r,e[6]=n,e[7]=a,e[8]=w,e[9]=P):(w=e[8],P=e[9]),m.useEffect(w,P);const[x,j]=_o();if(j==="loading"||a&&(!o||typeof o.granted>"u"||!l||typeof l.granted>"u"||!f||!d||typeof d.granted>"u"||typeof f.granted>"u")){let E;return e[10]===Symbol.for("react.memo_cache_sentinel")?(E=u.jsx(wn,{}),e[10]=E):E=e[10],E}const R=g===!0,_=(o==null?void 0:o.granted)===!0&&(l==null?void 0:l.granted)===!0,I=(d==null?void 0:d.granted)===!0;let S;return e[11]!==t||e[12]!==R||e[13]!==_||e[14]!==I||e[15]!==x?(S=u.jsx(xo,{...t,vercelProtectionBypass:x,canCreateUrlPreviewSecrets:R,canToggleSharePreviewAccess:_,canUseSharedPreviewAccess:I}),e[11]=t,e[12]=R,e[13]=_,e[14]=I,e[15]=x,e[16]=S):S=e[16],S}const ko=Object.freeze(Object.defineProperty({__proto__:null,default:Eo},Symbol.toStringTag,{value:"Module"}));export{ko as P,Co as a,Wn as b,Cs as c,ot as d,rn as e,Io as g,Ao as p,$o as r,Is as t,We as w};
